<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rangitoto Year 9 Review Hub v8</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #4c1d95 100%); min-height: 100vh; color: white; }
        .container { max-width: 1000px; margin: 0 auto; padding: 20px; }
        .glass { background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2); border-radius: 20px; padding: 25px; margin-bottom: 20px; }
        .btn { background: linear-gradient(135deg, #8b5cf6, #ec4899); border: none; color: white; padding: 15px 30px; border-radius: 12px; font-size: 16px; font-weight: bold; cursor: pointer; transition: all 0.2s; width: 100%; margin-bottom: 10px; }
        .btn:hover { transform: scale(1.02); box-shadow: 0 10px 30px rgba(139,92,246,0.4); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .btn-secondary { background: rgba(255,255,255,0.2); }
        .btn-small { padding: 10px 16px; font-size: 14px; width: auto; }
        .btn-green { background: linear-gradient(135deg, #22c55e, #14b8a6); }
        .btn-blue { background: linear-gradient(135deg, #3b82f6, #06b6d4); }
        .btn-orange { background: linear-gradient(135deg, #f97316, #eab308); }
        .input { width: 100%; padding: 15px 20px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.3); background: rgba(255,255,255,0.1); color: white; font-size: 16px; margin-bottom: 15px; }
        .input::placeholder { color: rgba(255,255,255,0.5); }
        .input:focus { outline: none; border-color: #8b5cf6; }
        textarea.input { min-height: 100px; resize: vertical; font-family: monospace; font-size: 12px; }
        /* New Question Type Styles */
        .fill-input { padding: 12px 16px; border-radius: 8px; border: 2px solid rgba(255,255,255,0.3); background: rgba(255,255,255,0.15); color: white; font-size: 18px; width: 200px; text-align: center; }
        .fill-input:focus { outline: none; border-color: #8b5cf6; background: rgba(139,92,246,0.2); }
        .tf-container { display: flex; gap: 15px; justify-content: center; margin: 20px 0; }
        .tf-btn { padding: 20px 50px; border-radius: 15px; border: 3px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.1); color: white; font-size: 18px; font-weight: bold; cursor: pointer; transition: all 0.2s; }
        .tf-btn:hover { transform: scale(1.05); }
        .tf-btn.selected-true { background: rgba(34,197,94,0.4); border-color: #22c55e; }
        .tf-btn.selected-false { background: rgba(239,68,68,0.4); border-color: #ef4444; }
        .multi-option { display: flex; align-items: center; gap: 12px; padding: 15px 20px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.1); margin-bottom: 10px; cursor: pointer; transition: all 0.2s; }
        .multi-option:hover { background: rgba(139,92,246,0.2); }
        .multi-option.selected { background: rgba(139,92,246,0.3); border-color: #8b5cf6; }
        .multi-checkbox { width: 24px; height: 24px; border-radius: 6px; border: 2px solid rgba(255,255,255,0.4); display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .multi-option.selected .multi-checkbox { background: #8b5cf6; border-color: #8b5cf6; }
        .match-container { display: grid; grid-template-columns: 1fr auto 1fr; gap: 15px; align-items: start; }
        .match-col { display: flex; flex-direction: column; gap: 10px; }
        .match-item { padding: 12px 16px; border-radius: 10px; background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.2); cursor: pointer; transition: all 0.2s; text-align: center; }
        .match-item:hover { background: rgba(139,92,246,0.2); }
        .match-item.selected { background: rgba(139,92,246,0.3); border-color: #8b5cf6; }
        .match-item.matched { background: rgba(34,197,94,0.3); border-color: #22c55e; opacity: 0.7; }
        .match-lines { display: flex; flex-direction: column; gap: 10px; justify-content: center; align-items: center; }
        .match-pair { display: flex; align-items: center; gap: 10px; background: rgba(34,197,94,0.2); padding: 8px 12px; border-radius: 8px; font-size: 14px; }
        .short-input { width: 100%; padding: 15px 20px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.3); background: rgba(255,255,255,0.15); color: white; font-size: 16px; }
        .short-input:focus { outline: none; border-color: #8b5cf6; }
        .type-badge { display: inline-block; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: bold; margin-left: 8px; }
        .type-mcq { background: #3b82f6; }
        .type-fill { background: #22c55e; }
        .type-tf { background: #f97316; }
        .type-multi { background: #8b5cf6; }
        .type-match { background: #ec4899; }
        .type-short { background: #14b8a6; }
        .text-center { text-align: center; }
        .mb-2 { margin-bottom: 8px; }
        .mb-4 { margin-bottom: 16px; }
        .mt-2 { margin-top: 8px; }
        .mt-4 { margin-top: 16px; }
        .text-6xl { font-size: 60px; }
        .text-4xl { font-size: 36px; }
        .text-3xl { font-size: 30px; }
        .text-2xl { font-size: 24px; }
        .text-xl { font-size: 20px; }
        .text-lg { font-size: 18px; }
        .text-sm { font-size: 14px; }
        .text-xs { font-size: 12px; }
        .text-gray { color: rgba(255,255,255,0.6); }
        .text-yellow { color: #fbbf24; }
        .text-green { color: #34d399; }
        .text-red { color: #f87171; }
        .text-purple { color: #c084fc; }
        .text-blue { color: #60a5fa; }
        .font-bold { font-weight: bold; }
        .hidden { display: none; }
        .flex { display: flex; }
        .flex-wrap { flex-wrap: wrap; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .justify-center { justify-content: center; }
        .gap-2 { gap: 8px; }
        .gap-3 { gap: 12px; }
        .gap-4 { gap: 16px; }
        .grid { display: grid; }
        .grid-2 { grid-template-columns: repeat(2, 1fr); }
        .grid-3 { grid-template-columns: repeat(3, 1fr); }
        .grid-4 { grid-template-columns: repeat(4, 1fr); }
        .subject-card { background: linear-gradient(135deg, var(--from), var(--to)); padding: 20px; border-radius: 16px; cursor: pointer; transition: transform 0.2s; text-align: left; border: none; color: white; width: 100%; }
        .subject-card:hover { transform: translateY(-5px); }
        .subject-card .icon { font-size: 40px; margin-bottom: 10px; }
        .option-btn { background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.2); color: white; padding: 15px 20px; border-radius: 12px; cursor: pointer; text-align: left; transition: all 0.2s; margin-bottom: 10px; display: block; width: 100%; font-size: 16px; }
        .option-btn:hover:not(:disabled) { background: rgba(139,92,246,0.3); transform: translateX(5px); }
        .option-btn.selected { background: rgba(139,92,246,0.4); border-color: #8b5cf6; }
        .option-btn.correct { background: rgba(34,197,94,0.3); border-color: #22c55e; }
        .option-btn.wrong { background: rgba(239,68,68,0.3); border-color: #ef4444; }
        .progress-bar { height: 10px; background: rgba(255,255,255,0.2); border-radius: 5px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #8b5cf6, #ec4899); border-radius: 5px; transition: width 0.5s; }
        .progress-fill.green { background: linear-gradient(90deg, #22c55e, #14b8a6); }
        .stats-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .badge-tag { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; }
        .badge-green { background: #22c55e; }
        .badge-yellow { background: #eab308; }
        .badge-purple { background: #8b5cf6; }
        .badge-blue { background: #3b82f6; }
        .badge-red { background: #ef4444; }
        .badge-orange { background: #f97316; }
        .nav { display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap; }
        .nav-btn { background: rgba(255,255,255,0.1); border: none; color: white; padding: 10px 16px; border-radius: 10px; cursor: pointer; font-size: 14px; }
        .nav-btn.active { background: linear-gradient(135deg, #8b5cf6, #ec4899); }
        .header { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; margin-bottom: 20px; }
        .health-bar { padding: 8px 16px; border-radius: 10px; font-weight: bold; }
        .health-good { background: linear-gradient(135deg, #22c55e, #34d399); }
        .health-warning { background: linear-gradient(135deg, #f59e0b, #fbbf24); }
        .health-danger { background: linear-gradient(135deg, #ef4444, #f87171); }
        .alert { padding: 15px; border-radius: 12px; margin-bottom: 15px; }
        .alert-success { background: rgba(34,197,94,0.2); border: 1px solid rgba(34,197,94,0.5); }
        .tabs { display: flex; gap: 5px; margin-bottom: 20px; }
        .tab { padding: 10px 20px; background: rgba(255,255,255,0.1); border: none; color: white; border-radius: 10px 10px 0 0; cursor: pointer; }
        .tab.active { background: rgba(255,255,255,0.2); }
        .week-plan-card { background: linear-gradient(135deg, var(--from), var(--to)); border-radius: 16px; padding: 20px; margin-bottom: 15px; position: relative; overflow: hidden; }
        .week-plan-card .week-number { font-size: 48px; font-weight: bold; opacity: 0.3; position: absolute; right: 20px; top: 10px; }
        .week-plan-card .topic-item { background: rgba(255,255,255,0.15); padding: 8px 12px; border-radius: 8px; margin: 5px 0; font-size: 14px; display: inline-block; }
        .week-card { background: rgba(255,255,255,0.08); border-radius: 16px; padding: 20px; margin-bottom: 15px; border-left: 4px solid var(--accent); }
        .week-card.current { background: rgba(139,92,246,0.2); }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px; }
        .calendar-day-header { text-align: center; font-size: 11px; color: rgba(255,255,255,0.5); padding: 5px; font-weight: bold; }
        .calendar-day { aspect-ratio: 1; border-radius: 10px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s; position: relative; background: rgba(255,255,255,0.05); border: 2px solid transparent; min-height: 60px; }
        .calendar-day:hover { transform: scale(1.08); background: rgba(255,255,255,0.15); }
        .calendar-day.today { border-color: #fbbf24; box-shadow: 0 0 15px rgba(251,191,36,0.5); }
        .calendar-day.completed { background: linear-gradient(135deg, rgba(34,197,94,0.4), rgba(20,184,166,0.4)); border-color: #22c55e; }
        .calendar-day.partial { background: linear-gradient(135deg, rgba(251,191,36,0.4), rgba(249,115,22,0.4)); border-color: #f59e0b; }
        .calendar-day.future { opacity: 0.4; }
        .calendar-day.past-incomplete { background: rgba(239,68,68,0.2); border-color: rgba(239,68,68,0.5); }
        .calendar-day.rest-day { background: rgba(139,92,246,0.3); }
        .calendar-day .day-num { font-size: 14px; font-weight: bold; }
        .calendar-day .day-icon { font-size: 18px; margin-top: 2px; }
        .calendar-day .day-progress { position: absolute; bottom: 3px; left: 3px; right: 3px; height: 3px; background: rgba(255,255,255,0.2); border-radius: 2px; }
        .calendar-day .day-progress-fill { height: 100%; background: #22c55e; border-radius: 2px; }
        .calendar-day.disabled { pointer-events: none; opacity: 0.2; }
        .task-status { padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: bold; }
        .status-complete { background: #22c55e; }
        .status-partial { background: #f59e0b; }
        .status-pending { background: rgba(255,255,255,0.2); }
        .badge-card { background: rgba(255,255,255,0.1); border-radius: 16px; padding: 15px; text-align: center; position: relative; }
        .badge-card.earned { background: linear-gradient(135deg, rgba(139,92,246,0.3), rgba(236,72,153,0.3)); border: 2px solid rgba(139,92,246,0.5); }
        .badge-card.locked { opacity: 0.5; filter: grayscale(0.8); }
        .badge-card .badge-icon { font-size: 32px; margin-bottom: 6px; display: block; }
        .badge-card .badge-name { font-weight: bold; font-size: 11px; }
        .badge-card .badge-desc { font-size: 9px; color: rgba(255,255,255,0.6); }
        .badge-card.earned::after { content: '‚úì'; position: absolute; top: 6px; right: 6px; background: #22c55e; width: 18px; height: 18px; border-radius: 50%; font-size: 10px; display: flex; align-items: center; justify-content: center; }
        .topic-btn { background: rgba(255,255,255,0.1); border: none; color: white; padding: 12px 16px; border-radius: 10px; cursor: pointer; width: 100%; text-align: left; margin-top: 8px; display: flex; justify-content: space-between; }
        .topic-btn:hover { background: rgba(255,255,255,0.2); }
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 1000; padding: 20px; }
        .modal { background: linear-gradient(135deg, #1e1b4b, #312e81); border-radius: 20px; padding: 30px; max-width: 550px; width: 100%; max-height: 90vh; overflow-y: auto; }
        .q-nav { display: flex; gap: 10px; margin-top: 20px; }
        .q-nav .btn { flex: 1; }
        .q-dots { display: flex; gap: 8px; justify-content: center; margin-top: 15px; flex-wrap: wrap; }
        .q-dot { width: 32px; height: 32px; border-radius: 50%; background: rgba(255,255,255,0.2); border: 2px solid transparent; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; transition: all 0.2s; }
        .q-dot:hover { background: rgba(255,255,255,0.3); }
        .q-dot.current { border-color: #8b5cf6; background: rgba(139,92,246,0.3); }
        .q-dot.answered { background: rgba(59,130,246,0.4); }
        .review-item { background: rgba(255,255,255,0.05); border-radius: 12px; padding: 15px; margin-bottom: 10px; border-left: 4px solid; }
        .review-item.correct { border-color: #22c55e; }
        .review-item.wrong { border-color: #ef4444; }
        .review-q { font-weight: bold; margin-bottom: 8px; }
        .review-answer { font-size: 14px; }
        .stat-card { background: rgba(255,255,255,0.08); border-radius: 12px; padding: 15px; text-align: center; }
        .stat-card .stat-num { font-size: 28px; font-weight: bold; }
        .stat-card .stat-label { font-size: 12px; color: rgba(255,255,255,0.6); }
        .diff-bar { display: flex; height: 24px; border-radius: 6px; overflow: hidden; margin: 10px 0; }
        .diff-bar > div { display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: bold; }
        @keyframes float { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .floating { animation: float 3s ease-in-out infinite; }
        @keyframes bounce { 0% { transform: scale(0); } 100% { transform: scale(1); } }
        .bounce-in { animation: bounce 0.5s cubic-bezier(0.68,-0.55,0.265,1.55); }
        @keyframes glow { 0%, 100% { box-shadow: 0 0 10px rgba(251,191,36,0.4); } 50% { box-shadow: 0 0 25px rgba(251,191,36,0.8); } }
        .today-glow { animation: glow 2s ease-in-out infinite; }
        @media (max-width: 700px) { 
            .grid-2, .grid-4 { grid-template-columns: 1fr 1fr; } 
            .grid-3 { grid-template-columns: repeat(3, 1fr); } 
            .calendar-day { min-height: 50px; }
            .calendar-day .day-num { font-size: 12px; }
            .calendar-day .day-icon { font-size: 14px; }
            .nav-btn { padding: 8px 12px; font-size: 12px; }
            .q-nav { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container" id="app"></div>
    <script>
// ============ STUDY PLAN ============
const PLAN_START = new Date('2025-12-06'), PLAN_END = new Date('2026-01-17'), DAILY_GOAL = 2;
const weeklyPlan = [
    { week: 1, name: "Week 1", dates: "Dec 6-12", subject: "math", topic: "Number & Algebra", icon: "üìê", color: { from: "#3b82f6", to: "#06b6d4" }, description: "Master numbers and algebra", keyTopics: ["Integers", "Fractions", "Percentages", "Algebra", "Indices"], dailyGoal: "2 exams/day", targetGrade: "E7-E8" },
    { week: 2, name: "Week 2", dates: "Dec 13-19", subject: "english", topic: "Reading & Vocabulary", icon: "üìö", color: { from: "#8b5cf6", to: "#ec4899" }, description: "Build vocabulary and comprehension", keyTopics: ["Synonyms", "Antonyms", "Prefixes", "Suffixes", "Comprehension"], dailyGoal: "2 exams/day", targetGrade: "M5-M6" },
    { week: 3, name: "Week 3", dates: "Dec 20-26", subject: "math", topic: "Geometry & Statistics", icon: "üìê", color: { from: "#3b82f6", to: "#06b6d4" }, holiday: true, description: "Shapes and data analysis", keyTopics: ["Angles", "Area", "Pythagoras", "Statistics"], dailyGoal: "1-2 exams/day", targetGrade: "E7-E8", note: "üéÑ Dec 25 rest" },
    { week: 4, name: "Week 4", dates: "Dec 27-Jan 2", subject: "science", topic: "All Science", icon: "üî¨", color: { from: "#22c55e", to: "#14b8a6" }, holiday: true, description: "Chemistry, Biology, Physics", keyTopics: ["Atoms", "Cells", "Forces", "Energy"], dailyGoal: "1-2 exams/day", targetGrade: "M6-E7", note: "üéÜ Jan 1 rest" },
    { week: 5, name: "Week 5", dates: "Jan 3-9", subject: "english", topic: "Grammar & Writing", icon: "üìö", color: { from: "#8b5cf6", to: "#ec4899" }, description: "Perfect grammar skills", keyTopics: ["Tenses", "Sentences", "Punctuation", "Essays"], dailyGoal: "2 exams/day", targetGrade: "M5-M6" },
    { week: 6, name: "Week 6", dates: "Jan 10-17", subject: "all", topic: "Final Review", icon: "üéØ", color: { from: "#f97316", to: "#ef4444" }, description: "Comprehensive review", keyTopics: ["All Subjects"], dailyGoal: "2-3 exams/day", targetGrade: "E7-E8", note: "üí™ Final push!" }
];
const restDays = ['2025-12-25', '2026-01-01'];
function generateDailyPlan() { const days = []; let cur = new Date(PLAN_START), idx = 0; while (cur <= PLAN_END) { const ds = cur.toISOString().split('T')[0], wn = Math.floor(idx / 7), wp = weeklyPlan[Math.min(wn, 5)], ir = restDays.includes(ds); days.push({ date: ds, dayIndex: idx, week: wn + 1, weekPlan: wp, subject: ir ? null : wp.subject, topic: ir ? null : wp.topic, icon: ir ? 'üéÑ' : wp.icon, isRest: ir, goal: ir ? 0 : (wp.holiday ? 1 : DAILY_GOAL), dayOfWeek: cur.getDay() }); cur.setDate(cur.getDate() + 1); idx++; } return days; }
const dailyPlan = generateDailyPlan();

// ============ BADGES ============
const badgesDef = {
    first_steps: { icon: 'üéØ', name: 'First Steps', desc: 'Complete 1 exam', check: s => s.exams >= 1 },
    on_fire: { icon: 'üî•', name: 'On Fire', desc: '3-day streak', check: s => s.streak >= 3 },
    week_warrior: { icon: '‚öîÔ∏è', name: 'Week Warrior', desc: '7-day streak', check: s => s.streak >= 7 },
    perfectionist: { icon: 'üíØ', name: 'Perfectionist', desc: 'Get 100%', check: s => s.perfect >= 1 },
    math_wizard: { icon: 'üßô', name: 'Math Wizard', desc: '5 Math exams', check: s => s.subjects.math >= 5 },
    wordsmith: { icon: 'üìñ', name: 'Wordsmith', desc: '5 English exams', check: s => s.subjects.english >= 5 },
    scientist: { icon: 'üî≠', name: 'Scientist', desc: '5 Science exams', check: s => s.subjects.science >= 5 },
    historian: { icon: 'üåè', name: 'Historian', desc: '5 Social exams', check: s => s.subjects.social >= 5 },
    excellence: { icon: 'üèÜ', name: 'Excellence', desc: 'Get E7/E8', check: s => s.excellence >= 1 },
    dedicated: { icon: 'üìö', name: 'Dedicated', desc: '10 exams', check: s => s.exams >= 10 },
    speed_demon: { icon: '‚ö°', name: 'Speed Demon', desc: 'Finish <2min', check: s => s.fastExams >= 1 },
    unstoppable: { icon: 'üöÄ', name: 'Unstoppable', desc: '25 exams', check: s => s.exams >= 25 },
    master: { icon: 'üëë', name: 'Master', desc: '5000+ XP', check: s => s.xp >= 5000 },
    streak_king: { icon: 'üî•', name: 'Streak King', desc: '14-day streak', check: s => s.streak >= 14 },
    all_rounder: { icon: 'üåü', name: 'All Rounder', desc: '3+ each subject', check: s => s.subjects.math >= 3 && s.subjects.english >= 3 && s.subjects.science >= 3 && s.subjects.social >= 3 }
};

// ============ QUESTION DATABASE (500+ Questions with balanced difficulty) ============
// Difficulty: A3-A4 (Achieved 40-59%), M5-M6 (Merit 60-79%), E7-E8 (Excellence 80-100%)
// Math target: E7-E8, English: M5-M6, Science: M6-E7, Social: M5-M6

const questions = {
    math: {
        name: "Mathematics", icon: "üìê", from: "#3b82f6", to: "#06b6d4", target: "E7-E8",
        topics: {
            "Integers": [
                { type: "mcq", q: "-5 + 8 = ?", opts: ["3", "-3", "13", "-13"], ans: 0, exp: "-5 + 8 = 3", diff: "A3" },
                { type: "mcq", q: "-12 √∑ (-4) = ?", opts: ["3", "-3", "8", "-8"], ans: 0, exp: "Negative √∑ negative = positive", diff: "A4" },
                { type: "fill", q: "Calculate: (-3) √ó (-7) = ___", ans: "21", exp: "Negative √ó negative = positive", diff: "A4" },
                { type: "tf", q: "-15 + (-8) = -23", ans: true, exp: "Adding negatives: -15-8=-23", diff: "M5" },
                { type: "fill", q: "20 - (-5) = ___", ans: "25", exp: "Subtracting negative = adding", diff: "M5" },
                { type: "mcq", q: "(-6)¬≤ = ?", opts: ["36", "-36", "12", "-12"], ans: 0, exp: "(-6)√ó(-6) = 36", diff: "M6" },
                { type: "fill", q: "|-7| + |-3| = ___", ans: "10", exp: "7 + 3 = 10", diff: "M5" },
                { type: "mcq", q: "-2 √ó (-3) √ó (-4) = ?", opts: ["-24", "24", "-9", "9"], ans: 0, exp: "Odd number of negatives = negative", diff: "M6" },
                { type: "tf", q: "(-5)¬≥ = 125", ans: false, exp: "(-5)¬≥ = -125 (odd power keeps negative)", diff: "E7" },
                { type: "fill", q: "If a = -3 and b = 4, find a¬≤ - b = ___", ans: "5", exp: "9 - 4 = 5", diff: "E7" },
                { type: "mcq", q: "Solve: -3x = 24", opts: ["-8", "8", "-21", "21"], ans: 0, exp: "x = 24 √∑ (-3) = -8", diff: "M6" },
                { type: "mcq", q: "(-2)‚Å¥ √ó (-1)¬≥ = ?", opts: ["-16", "16", "-8", "8"], ans: 0, exp: "16 √ó (-1) = -16", diff: "E7" },
                { type: "multi", q: "Select ALL negative numbers:", opts: ["-5", "3", "-8", "0", "-1"], ans: [0, 2, 4], exp: "-5, -8, and -1 are negative", diff: "A3" },
                { type: "tf", q: "(-4)¬≤ - (-3)¬≤ = 7", ans: true, exp: "16 - 9 = 7", diff: "E7" },
                { type: "fill", q: "If x = -2, find 3x¬≤ - 2x = ___", ans: "16", exp: "12 - (-4) = 16", diff: "E8" }
            ],
            "Fractions": [
                { type: "fill", q: "Simplify: 12/18 = ___", ans: "2/3", exp: "√∑6 each = 2/3", diff: "A4" },
                { type: "mcq", q: "1/4 + 2/4 = ?", opts: ["3/4", "3/8", "1/2", "2/4"], ans: 0, exp: "Same denominator: 1+2=3", diff: "A3" },
                { type: "fill", q: "2/3 √ó 3/4 = ___", ans: "1/2", exp: "6/12 = 1/2", diff: "M5" },
                { type: "mcq", q: "1/2 + 1/3 = ?", opts: ["5/6", "2/5", "1/5", "2/6"], ans: 0, exp: "3/6 + 2/6 = 5/6", diff: "M5" },
                { type: "tf", q: "3/4 √∑ 1/2 = 3/8", ans: false, exp: "3/4 √ó 2/1 = 3/2 (not 3/8)", diff: "M6" },
                { type: "mcq", q: "2/5 + 3/10 = ?", opts: ["7/10", "5/15", "1/2", "5/10"], ans: 0, exp: "4/10 + 3/10 = 7/10", diff: "M6" },
                { type: "fill", q: "5/6 - 1/4 = ___", ans: "7/12", exp: "10/12 - 3/12 = 7/12", diff: "E7" },
                { type: "mcq", q: "2¬æ + 1¬Ω = ?", opts: ["4¬º", "3¬º", "4¬Ω", "3¬æ"], ans: 0, exp: "2.75 + 1.5 = 4.25", diff: "E7" },
                { type: "fill", q: "(2/3)¬≤ = ___", ans: "4/9", exp: "4/9", diff: "E7" },
                { type: "tf", q: "3/4 of 2/5 = 6/20", ans: true, exp: "6/20 = 3/10 ‚úì", diff: "M6" },
                { type: "mcq", q: "1‚Öì √ó 2¬º = ?", opts: ["3", "2¬Ω", "3¬Ω", "2¬æ"], ans: 0, exp: "4/3 √ó 9/4 = 3", diff: "E8" },
                { type: "fill", q: "If x/4 = 3/8, find x = ___", ans: "1.5", exp: "x = 12/8 = 1.5", diff: "E7" },
                { type: "multi", q: "Select fractions EQUAL to 1/2:", opts: ["2/4", "3/5", "4/8", "5/10", "2/3"], ans: [0, 2, 3], exp: "2/4, 4/8, 5/10 all equal 1/2", diff: "M5" },
                { type: "mcq", q: "2/3 √∑ 4/5 = ?", opts: ["5/6", "8/15", "6/5", "10/12"], ans: 0, exp: "2/3 √ó 5/4 = 10/12 = 5/6", diff: "E7" },
                { type: "fill", q: "Solve: x/3 + x/4 = 7, x = ___", ans: "12", exp: "7x/12 = 7, x = 12", diff: "E8" }
            ],
            "Percentages": [
                { type: "fill", q: "25% of 200 = ___", ans: "50", exp: "0.25 √ó 200 = 50", diff: "A3" },
                { type: "fill", q: "15% of 80 = ___", ans: "12", exp: "0.15 √ó 80 = 12", diff: "A4" },
                { type: "mcq", q: "Convert 3/5 to %", opts: ["60%", "35%", "53%", "65%"], ans: 0, exp: "3√∑5 = 0.6 = 60%", diff: "M5" },
                { type: "fill", q: "$40 with 20% off = $___", ans: "32", exp: "40 - 8 = 32", diff: "M5" },
                { type: "mcq", q: "30 out of 50 = ?%", opts: ["60%", "30%", "50%", "80%"], ans: 0, exp: "30√∑50 = 60%", diff: "M5" },
                { type: "fill", q: "Price rises 25% from $80. New price = $___", ans: "100", exp: "80 + 20 = 100", diff: "M6" },
                { type: "mcq", q: "$60 to $45 = what % off?", opts: ["25%", "15%", "30%", "20%"], ans: 0, exp: "15√∑60 = 25%", diff: "E7" },
                { type: "mcq", q: "After 20% increase, price is $60. Original?", opts: ["$50", "$48", "$52", "$55"], ans: 0, exp: "60√∑1.2 = 50", diff: "E7" },
                { type: "tf", q: "200% of 25 equals 50", ans: true, exp: "2 √ó 25 = 50", diff: "M5" },
                { type: "fill", q: "Decrease 80 by 35% = ___", ans: "52", exp: "80 √ó 0.65 = 52", diff: "M6" },
                { type: "mcq", q: "A is 20% more than B. If A=60, B=?", opts: ["50", "48", "72", "52"], ans: 0, exp: "60√∑1.2 = 50", diff: "E7" },
                { type: "mcq", q: "Compound: $100, 10%/year, 2 years", opts: ["$121", "$120", "$110", "$122"], ans: 0, exp: "100√ó1.1√ó1.1 = 121", diff: "E8" },
                { type: "mcq", q: "What % is 18 of 72?", opts: ["25%", "18%", "72%", "4%"], ans: 0, exp: "18√∑72 = 0.25", diff: "M6" },
                { type: "mcq", q: "Profit margin: cost $40, sell $50", opts: ["25%", "20%", "10%", "50%"], ans: 0, exp: "10√∑40 = 25%", diff: "E7" },
                { type: "mcq", q: "Sale price $75 after 25% off. Original?", opts: ["$100", "$93.75", "$56.25", "$90"], ans: 0, exp: "75√∑0.75 = 100", diff: "E8" }
            ],
            "Algebra": [
                { type: "fill", q: "Simplify: 3x + 5x - 2x = ___x", ans: "6", exp: "(3+5-2)x = 6x", diff: "A4" },
                { type: "fill", q: "Solve: 2x + 7 = 15, x = ___", ans: "4", exp: "2x = 8, x = 4", diff: "M5" },
                { type: "mcq", q: "Expand: 2(x + 3)", opts: ["2x + 6", "2x + 3", "x + 6", "2x + 5"], ans: 0, exp: "2√óx + 2√ó3", diff: "M5" },
                { type: "mcq", q: "Simplify: 4x + 3y - 2x + y", opts: ["2x + 4y", "6x + 4y", "2x + 2y", "6x + 2y"], ans: 0, exp: "Combine like terms", diff: "M5" },
                { type: "mcq", q: "Expand: 3(2x - 4)", opts: ["6x - 12", "6x - 4", "5x - 7", "6x + 12"], ans: 0, exp: "3√ó2x - 3√ó4", diff: "M6" },
                { type: "mcq", q: "Factorise: 6x + 12", opts: ["6(x + 2)", "6(x + 12)", "3(2x + 4)", "2(3x + 6)"], ans: 0, exp: "6 is common factor", diff: "M6" },
                { type: "fill", q: "Solve: 2(x + 3) = 14, x = ___", ans: "4", exp: "2x + 6 = 14, x = 4", diff: "M6" },
                { type: "mcq", q: "Factorise: x¬≤ - 9", opts: ["(x+3)(x-3)", "(x+9)(x-1)", "(x-3)¬≤", "(x+3)¬≤"], ans: 0, exp: "Difference of squares", diff: "E7" },
                { type: "fill", q: "Solve: 4x - 3 = 2x + 7, x = ___", ans: "5", exp: "2x = 10, x = 5", diff: "E7" },
                { type: "mcq", q: "Expand: (x+2)(x+3)", opts: ["x¬≤+5x+6", "x¬≤+6x+5", "x¬≤+5x+5", "2x+5"], ans: 0, exp: "x¬≤ + 3x + 2x + 6", diff: "E7" },
                { type: "multi", q: "Solutions to x¬≤ = 49:", opts: ["7", "-7", "49", "-49", "0"], ans: [0, 1], exp: "x = +7 or -7", diff: "E7" },
                { type: "mcq", q: "Factorise: x¬≤ + 5x + 6", opts: ["(x+2)(x+3)", "(x+1)(x+6)", "(x+5)(x+1)", "(x+3)¬≤"], ans: 0, exp: "2+3=5, 2√ó3=6", diff: "E8" },
                { type: "fill", q: "Solve: 3(x-2) = 2(x+1), x = ___", ans: "8", exp: "3x-6=2x+2, x=8", diff: "E8" },
                { type: "mcq", q: "Simplify: (2x¬≤)(3x¬≥)", opts: ["6x‚Åµ", "5x‚Åµ", "6x‚Å∂", "5x‚Å∂"], ans: 0, exp: "2√ó3=6, 2+3=5", diff: "E7" },
                { type: "tf", q: "(x-4)(x+4) = x¬≤ - 16", ans: true, exp: "Difference of squares", diff: "E7" },
                { type: "fill", q: "Solve: x/2 + 3 = 7, x = ___", ans: "8", exp: "x/2 = 4, x = 8", diff: "M6" },
                { type: "mcq", q: "Factorise: 2x¬≤ + 6x", opts: ["2x(x+3)", "2(x¬≤+3x)", "x(2x+6)", "6x(x+1)"], ans: 0, exp: "2x is common", diff: "E7" },
                { type: "fill", q: "Solve: x¬≤ - 5x + 6 = 0. Smaller x = ___", ans: "2", exp: "(x-2)(x-3)=0", diff: "E8" }
            ],
            "Indices": [
                { q: "2¬≥ = ?", opts: ["8", "6", "9", "5"], ans: 0, exp: "2√ó2√ó2 = 8", diff: "A3" },
                { q: "5¬≤ = ?", opts: ["25", "10", "52", "125"], ans: 0, exp: "5√ó5 = 25", diff: "A3" },
                { q: "10‚Å∞ = ?", opts: ["1", "0", "10", "100"], ans: 0, exp: "Any number‚Å∞ = 1", diff: "A4" },
                { q: "2¬≥ √ó 2¬≤ = ?", opts: ["32", "16", "64", "8"], ans: 0, exp: "2‚Åµ = 32", diff: "M5" },
                { q: "2‚Å¥ √∑ 2¬≤ = ?", opts: ["4", "2", "8", "16"], ans: 0, exp: "2¬≤ = 4", diff: "M5" },
                { q: "(2¬≥)¬≤ = ?", opts: ["64", "32", "12", "36"], ans: 0, exp: "2‚Å∂ = 64", diff: "M6" },
                { q: "3‚Å¥ = ?", opts: ["81", "12", "27", "64"], ans: 0, exp: "3√ó3√ó3√ó3", diff: "M5" },
                { q: "x‚Åµ √∑ x¬≤ = ?", opts: ["x¬≥", "x‚Å∑", "x¬≤‚Åµ", "x¬π‚Å∞"], ans: 0, exp: "5-2 = 3", diff: "M6" },
                { q: "2‚Åª¬π = ?", opts: ["1/2", "-2", "2", "-1"], ans: 0, exp: "Negative = reciprocal", diff: "E7" },
                { q: "(3¬≤)¬≥ = ?", opts: ["729", "18", "81", "27"], ans: 0, exp: "3‚Å∂ = 729", diff: "E7" },
                { q: "Simplify: (2x¬≥)¬≤", opts: ["4x‚Å∂", "2x‚Å∂", "4x‚Åµ", "2x‚Åµ"], ans: 0, exp: "4x‚Å∂", diff: "E7" },
                { q: "8^(2/3) = ?", opts: ["4", "8", "2", "16"], ans: 0, exp: "(‚àõ8)¬≤ = 2¬≤ = 4", diff: "E8" },
                { q: "Simplify: 27^(1/3)", opts: ["3", "9", "27", "1"], ans: 0, exp: "Cube root of 27", diff: "E7" },
                { q: "5‚Åª¬≤ = ?", opts: ["1/25", "-10", "25", "-25"], ans: 0, exp: "1/5¬≤ = 1/25", diff: "E7" },
                { q: "Simplify: x¬≥ √ó x‚Å¥ √ó x", opts: ["x‚Å∏", "x¬π¬≤", "x‚Å∑", "3x‚Å∏"], ans: 0, exp: "3+4+1 = 8", diff: "M6" },
                { q: "(x¬≤y¬≥)¬≤ = ?", opts: ["x‚Å¥y‚Å∂", "x‚Å¥y‚Åµ", "x¬≤y‚Å∂", "2x¬≤y¬≥"], ans: 0, exp: "Square each", diff: "E8" }
            ],
            "Sequences": [
                { q: "Next: 3, 7, 11, 15, ?", opts: ["19", "18", "20", "17"], ans: 0, exp: "+4 pattern", diff: "A4" },
                { q: "Next: 2, 4, 8, 16, ?", opts: ["32", "24", "20", "18"], ans: 0, exp: "√ó2 pattern", diff: "A4" },
                { q: "Next: 2, 6, 18, 54, ?", opts: ["162", "108", "72", "216"], ans: 0, exp: "√ó3 pattern", diff: "M5" },
                { q: "Next: 1, 4, 9, 16, ?", opts: ["25", "20", "24", "21"], ans: 0, exp: "Square numbers", diff: "M5" },
                { q: "nth term: 3, 6, 9, 12...", opts: ["3n", "n+3", "3+n", "n√ón"], ans: 0, exp: "Multiples of 3", diff: "M6" },
                { q: "Next: 1, 1, 2, 3, 5, ?", opts: ["8", "6", "7", "9"], ans: 0, exp: "Fibonacci", diff: "M6" },
                { q: "Next: 1, 8, 27, 64, ?", opts: ["125", "100", "81", "128"], ans: 0, exp: "Cube numbers", diff: "E7" },
                { q: "nth term: 2, 5, 8, 11...", opts: ["3n-1", "3n+2", "2n+3", "n+3"], ans: 0, exp: "3n - 1", diff: "E7" },
                { q: "Find 10th term: 4, 7, 10, 13...", opts: ["31", "28", "34", "25"], ans: 0, exp: "3n+1, n=10: 31", diff: "E7" },
                { q: "Geometric: a=2, r=3. 5th term?", opts: ["162", "48", "54", "108"], ans: 0, exp: "2√ó3‚Å¥ = 162", diff: "E8" },
                { q: "Sum: 1+2+3+...+10", opts: ["55", "50", "45", "100"], ans: 0, exp: "n(n+1)/2", diff: "E7" },
                { q: "nth term: 5, 8, 11, 14...", opts: ["3n+2", "3n+5", "n+5", "5n"], ans: 0, exp: "3n + 2", diff: "E7" },
                { q: "Find 20th term if nth = 2n+3", opts: ["43", "40", "46", "23"], ans: 0, exp: "2(20)+3 = 43", diff: "E8" }
            ],
            "Ratios": [
                { q: "Simplify: 15:25", opts: ["3:5", "1:2", "5:3", "15:25"], ans: 0, exp: "√∑5 = 3:5", diff: "A4" },
                { q: "Ratio 3:5, 24 boys. Girls?", opts: ["40", "30", "45", "35"], ans: 0, exp: "1 part=8, 5√ó8=40", diff: "M5" },
                { q: "Ratio 2:3, total 30. Smaller?", opts: ["12", "18", "10", "15"], ans: 0, exp: "5 parts=30, 2 parts=12", diff: "M6" },
                { q: "Scale 1:50. Model 3cm. Real?", opts: ["150cm", "53cm", "50cm", "15cm"], ans: 0, exp: "3√ó50 = 150", diff: "M6" },
                { q: "Share $60 ratio 1:2:3", opts: ["10,20,30", "15,20,25", "20,20,20", "12,24,24"], ans: 0, exp: "6 parts, 1 part=10", diff: "E7" },
                { q: "A:B=2:3, B:C=4:5. A:B:C=?", opts: ["8:12:15", "2:3:5", "4:6:5", "2:4:5"], ans: 0, exp: "Make B same: 8:12:15", diff: "E8" },
                { q: "If 3:x = x:12, find x", opts: ["6", "4", "9", "8"], ans: 0, exp: "x¬≤ = 36, x = 6", diff: "E8" },
                { q: "Recipe for 4: 200g flour. For 6?", opts: ["300g", "250g", "400g", "150g"], ans: 0, exp: "200√ó6√∑4 = 300", diff: "M6" },
                { q: "Map 1:25000. 4cm = ? km", opts: ["1km", "100m", "10km", "25km"], ans: 0, exp: "4√ó25000 = 100000cm = 1km", diff: "E7" },
                { q: "Simplify: 24:36:48", opts: ["2:3:4", "4:6:8", "6:9:12", "1:2:3"], ans: 0, exp: "√∑12 each", diff: "M6" }
            ],
            "Geometry-Angles": [
                { q: "What angle is 135¬∞?", opts: ["Obtuse", "Acute", "Right", "Reflex"], ans: 0, exp: "90¬∞-180¬∞ = obtuse", diff: "A3" },
                { q: "Angles on straight line sum?", opts: ["180¬∞", "360¬∞", "90¬∞", "270¬∞"], ans: 0, exp: "Supplementary", diff: "A4" },
                { q: "Triangle angles sum?", opts: ["180¬∞", "360¬∞", "90¬∞", "270¬∞"], ans: 0, exp: "Always 180¬∞", diff: "A4" },
                { q: "Complementary to 35¬∞?", opts: ["55¬∞", "145¬∞", "65¬∞", "125¬∞"], ans: 0, exp: "90-35=55", diff: "M5" },
                { q: "Supplementary to 120¬∞?", opts: ["60¬∞", "240¬∞", "30¬∞", "180¬∞"], ans: 0, exp: "180-120=60", diff: "M5" },
                { q: "Quadrilateral angles sum?", opts: ["360¬∞", "180¬∞", "270¬∞", "540¬∞"], ans: 0, exp: "4 sides = 360¬∞", diff: "M5" },
                { q: "Vertically opposite angles are?", opts: ["Equal", "Supplementary", "Complementary", "90¬∞"], ans: 0, exp: "Always equal", diff: "M6" },
                { q: "Interior angle regular hexagon?", opts: ["120¬∞", "60¬∞", "90¬∞", "108¬∞"], ans: 0, exp: "(6-2)√ó180√∑6=120", diff: "E7" },
                { q: "Exterior angles sum (any polygon)?", opts: ["360¬∞", "180¬∞", "540¬∞", "720¬∞"], ans: 0, exp: "Always 360¬∞", diff: "E7" },
                { q: "Interior angle regular pentagon?", opts: ["108¬∞", "120¬∞", "90¬∞", "72¬∞"], ans: 0, exp: "(5-2)√ó180√∑5=108", diff: "E7" },
                { q: "Polygon with interior 156¬∞. Sides?", opts: ["15", "12", "18", "20"], ans: 0, exp: "180-156=24, 360√∑24=15", diff: "E8" },
                { q: "Co-interior angles sum?", opts: ["180¬∞", "90¬∞", "360¬∞", "Equal"], ans: 0, exp: "On same side of transversal", diff: "M6" },
                { q: "Alternate angles are?", opts: ["Equal", "180¬∞", "90¬∞", "Supplementary"], ans: 0, exp: "Z-angles are equal", diff: "M6" },
                { q: "Sum of angles in octagon?", opts: ["1080¬∞", "720¬∞", "1440¬∞", "900¬∞"], ans: 0, exp: "(8-2)√ó180 = 1080", diff: "E7" }
            ],
            "Area-Perimeter": [
                { q: "Rectangle 8√ó5. Area?", opts: ["40 cm¬≤", "26 cm¬≤", "13 cm¬≤", "80 cm¬≤"], ans: 0, exp: "8√ó5 = 40", diff: "A3" },
                { q: "Rectangle 8√ó5. Perimeter?", opts: ["26 cm", "40 cm", "13 cm", "80 cm"], ans: 0, exp: "2(8+5) = 26", diff: "A4" },
                { q: "Square side 7. Area?", opts: ["49 cm¬≤", "28 cm¬≤", "14 cm¬≤", "21 cm¬≤"], ans: 0, exp: "7√ó7 = 49", diff: "A4" },
                { q: "Triangle: base 10, height 6. Area?", opts: ["30 cm¬≤", "60 cm¬≤", "16 cm¬≤", "8 cm¬≤"], ans: 0, exp: "¬Ω√ó10√ó6 = 30", diff: "M5" },
                { q: "Parallelogram: b=12, h=5. Area?", opts: ["60 cm¬≤", "34 cm¬≤", "17 cm¬≤", "120 cm¬≤"], ans: 0, exp: "b√óh = 60", diff: "M5" },
                { q: "Trapezium: a=4, b=6, h=5. Area?", opts: ["25 cm¬≤", "30 cm¬≤", "20 cm¬≤", "50 cm¬≤"], ans: 0, exp: "¬Ω(4+6)√ó5 = 25", diff: "M6" },
                { q: "Rectangle area 48, width 6. Length?", opts: ["8", "42", "54", "288"], ans: 0, exp: "48√∑6 = 8", diff: "M6" },
                { q: "Compound shape: 10√ó8 with 3√ó3 cut. Area?", opts: ["71 cm¬≤", "80 cm¬≤", "77 cm¬≤", "89 cm¬≤"], ans: 0, exp: "80-9 = 71", diff: "E7" },
                { q: "Sector 90¬∞, r=6. Area? (œÄ=3.14)", opts: ["28.26 cm¬≤", "113 cm¬≤", "9.42 cm¬≤", "56.52 cm¬≤"], ans: 0, exp: "¬º√óœÄ√ó36 = 28.26", diff: "E8" },
                { q: "Rhombus diagonals 6 & 8. Area?", opts: ["24 cm¬≤", "48 cm¬≤", "14 cm¬≤", "28 cm¬≤"], ans: 0, exp: "¬Ω√ó6√ó8 = 24", diff: "E7" },
                { q: "Equilateral triangle side 6. Perimeter?", opts: ["18 cm", "36 cm", "12 cm", "6 cm"], ans: 0, exp: "3√ó6 = 18", diff: "M5" },
                { q: "Square perimeter 36. Area?", opts: ["81 cm¬≤", "36 cm¬≤", "9 cm¬≤", "324 cm¬≤"], ans: 0, exp: "Side=9, 9¬≤=81", diff: "M6" }
            ],
            "Circles": [
                { q: "Circumference formula?", opts: ["2œÄr", "œÄr¬≤", "œÄd¬≤", "2œÄr¬≤"], ans: 0, exp: "C = 2œÄr", diff: "M5" },
                { q: "Area formula?", opts: ["œÄr¬≤", "2œÄr", "œÄd", "2œÄr¬≤"], ans: 0, exp: "A = œÄr¬≤", diff: "M5" },
                { q: "Diameter if radius 5?", opts: ["10", "5", "25", "15"], ans: 0, exp: "d = 2r = 10", diff: "A4" },
                { q: "Circumference: r=7 (œÄ=22/7)?", opts: ["44 cm", "154 cm", "22 cm", "88 cm"], ans: 0, exp: "2√ó22/7√ó7 = 44", diff: "M6" },
                { q: "Area: r=7 (œÄ=22/7)?", opts: ["154 cm¬≤", "44 cm¬≤", "49 cm¬≤", "308 cm¬≤"], ans: 0, exp: "22/7√ó49 = 154", diff: "M6" },
                { q: "Semicircle perimeter: d=10 (œÄ=3.14)?", opts: ["25.7 cm", "15.7 cm", "31.4 cm", "20 cm"], ans: 0, exp: "œÄr + d = 15.7+10", diff: "E7" },
                { q: "Arc length: 60¬∞, r=6 (œÄ=3.14)?", opts: ["6.28 cm", "12.56 cm", "3.14 cm", "18.84 cm"], ans: 0, exp: "60/360√ó2œÄr", diff: "E8" },
                { q: "Radius if circumference = 31.4?", opts: ["5", "10", "15.7", "3.14"], ans: 0, exp: "31.4√∑2œÄ = 5", diff: "E7" },
                { q: "Radius if area = 78.5 (œÄ=3.14)?", opts: ["5", "25", "10", "7.85"], ans: 0, exp: "‚àö(78.5/3.14) = 5", diff: "E7" },
                { q: "Annulus area: R=5, r=3 (œÄ=3.14)?", opts: ["50.24 cm¬≤", "78.5 cm¬≤", "28.26 cm¬≤", "25.12 cm¬≤"], ans: 0, exp: "œÄ(25-9) = 50.24", diff: "E8" }
            ],
            "Pythagoras": [
                { q: "Pythagoras: a¬≤+b¬≤=?", opts: ["c¬≤", "2c", "c", "ab"], ans: 0, exp: "Hypotenuse squared", diff: "M5" },
                { q: "Legs 3 & 4. Hypotenuse?", opts: ["5", "7", "6", "12"], ans: 0, exp: "9+16=25, ‚àö25=5", diff: "M6" },
                { q: "Legs 6 & 8. Hypotenuse?", opts: ["10", "14", "48", "7"], ans: 0, exp: "36+64=100, ‚àö100=10", diff: "M6" },
                { q: "Legs 5 & 12. Hypotenuse?", opts: ["13", "17", "60", "8.5"], ans: 0, exp: "25+144=169", diff: "E7" },
                { q: "Hypotenuse 10, leg 6. Other leg?", opts: ["8", "4", "16", "14"], ans: 0, exp: "100-36=64, ‚àö64=8", diff: "E7" },
                { q: "Is 7,24,25 right triangle?", opts: ["Yes", "No", "Maybe", "Need info"], ans: 0, exp: "49+576=625 ‚úì", diff: "E7" },
                { q: "Diagonal of 6√ó8 rectangle?", opts: ["10", "14", "7", "12"], ans: 0, exp: "Pythagoras: 6¬≤+8¬≤=100", diff: "E7" },
                { q: "3D diagonal: 3√ó4√ó12 box?", opts: ["13", "19", "12", "5"], ans: 0, exp: "‚àö(9+16+144)=13", diff: "E8" },
                { q: "Ladder 5m, base 3m from wall. Height?", opts: ["4m", "8m", "2m", "6m"], ans: 0, exp: "25-9=16, ‚àö16=4", diff: "E7" },
                { q: "Is 8,15,17 Pythagorean triple?", opts: ["Yes", "No", "Maybe", "Need info"], ans: 0, exp: "64+225=289=17¬≤", diff: "E7" },
                { q: "Square diagonal 10‚àö2. Side?", opts: ["10", "20", "5", "10‚àö2"], ans: 0, exp: "d = s‚àö2", diff: "E8" }
            ],
            "Statistics": [
                { type: "fill", q: "Mean of 4, 7, 8, 9, 12 = ___", ans: "8", exp: "40√∑5=8", diff: "A4" },
                { type: "mcq", q: "Median: 3, 7, 9, 12, 15?", opts: ["9", "7", "12", "9.2"], ans: 0, exp: "Middle = 9", diff: "A4" },
                { type: "fill", q: "Mode of 2, 4, 4, 5, 7, 4, 8 = ___", ans: "4", exp: "4 appears most", diff: "A4" },
                { type: "mcq", q: "Range: 15, 22, 8, 31, 19?", opts: ["23", "31", "8", "19"], ans: 0, exp: "31-8=23", diff: "M5" },
                { type: "fill", q: "Median of 2, 4, 6, 8 = ___", ans: "5", exp: "(4+6)/2=5", diff: "M5" },
                { type: "tf", q: "Probability of rolling a 6 on a fair die is 1/6", ans: true, exp: "1 of 6 outcomes", diff: "M5" },
                { type: "mcq", q: "Mean after adding 10 to each?", opts: ["Increases by 10", "Same", "Doubles", "Halves"], ans: 0, exp: "Mean shifts same", diff: "M6" },
                { type: "mcq", q: "Which unaffected by outliers?", opts: ["Median", "Mean", "Sum", "Range"], ans: 0, exp: "Median is robust", diff: "E7" },
                { type: "fill", q: "P(A)=0.3, P(B)=0.4, independent. P(A and B) = ___", ans: "0.12", exp: "0.3√ó0.4=0.12", diff: "E7" },
                { type: "mcq", q: "Std dev measures?", opts: ["Spread from mean", "Average", "Middle", "Most common"], ans: 0, exp: "Data spread", diff: "E8" },
                { type: "mcq", q: "Two dice. P(sum=7)?", opts: ["6/36", "7/36", "1/6", "1/12"], ans: 0, exp: "6 ways out of 36", diff: "E7" },
                { type: "fill", q: "Mean=70, 5 scores. Total = ___", ans: "350", exp: "70√ó5 = 350", diff: "M6" },
                { type: "tf", q: "IQR means Interquartile Range (Q3-Q1)", ans: true, exp: "Interquartile range", diff: "E7" }
            ]
        }
    },
    english: {
        name: "English ESOL", icon: "üìö", from: "#8b5cf6", to: "#ec4899", target: "M5-M6",
        topics: {
            "Synonyms": [
                { type: "mcq", q: "Synonym: 'happy'?", opts: ["Joyful", "Sad", "Angry", "Tired"], ans: 0, exp: "Joyful = happy", diff: "A3" },
                { type: "mcq", q: "Synonym: 'big'?", opts: ["Large", "Small", "Tiny", "Short"], ans: 0, exp: "Large = big", diff: "A3" },
                { type: "fill", q: "Find the synonym for 'fast': q___k", ans: "quick", exp: "Quick = fast", diff: "A4" },
                { type: "mcq", q: "Synonym: 'intelligent'?", opts: ["Smart", "Stupid", "Lazy", "Weak"], ans: 0, exp: "Smart = intelligent", diff: "M5" },
                { type: "match", q: "Match the synonyms:", left: ["happy", "big", "fast"], right: ["large", "quick", "joyful"], ans: [[0,2], [1,0], [2,1]], exp: "happy=joyful, big=large, fast=quick", diff: "M5" },
                { type: "mcq", q: "Synonym: 'exhausted'?", opts: ["Fatigued", "Energetic", "Active", "Lively"], ans: 0, exp: "Fatigued = very tired", diff: "M5" },
                { type: "tf", q: "'Brave' is a synonym for 'courageous'", ans: true, exp: "Brave = courageous", diff: "M5" },
                { type: "mcq", q: "Synonym: 'meticulous'?", opts: ["Careful", "Careless", "Sloppy", "Hasty"], ans: 0, exp: "Very careful, precise", diff: "M6" },
                { type: "mcq", q: "Synonym: 'abundant'?", opts: ["Plentiful", "Scarce", "Rare", "Few"], ans: 0, exp: "Plentiful = abundant", diff: "M6" },
                { type: "fill", q: "Synonym for 'concise': b___f", ans: "brief", exp: "Brief and clear", diff: "M6" },
                { type: "mcq", q: "Synonym: 'ancient'?", opts: ["Old", "New", "Modern", "Recent"], ans: 0, exp: "Old = ancient", diff: "A4" },
                { type: "multi", q: "Select ALL synonyms for 'difficult':", opts: ["Hard", "Easy", "Challenging", "Simple", "Tough"], ans: [0, 2, 4], exp: "Hard, challenging, tough = difficult", diff: "M6" },
                { type: "mcq", q: "Synonym: 'furious'?", opts: ["Angry", "Happy", "Calm", "Peaceful"], ans: 0, exp: "Very angry", diff: "M5" },
                { type: "mcq", q: "Synonym: 'commence'?", opts: ["Begin", "End", "Stop", "Continue"], ans: 0, exp: "Commence = start", diff: "M5" },
                { type: "tf", q: "'Enormous' means the same as 'tiny'", ans: false, exp: "Enormous = huge (opposite of tiny)", diff: "A4" },
                { type: "mcq", q: "Synonym: 'assist'?", opts: ["Help", "Hinder", "Block", "Stop"], ans: 0, exp: "Assist = help", diff: "A4" }
            ],
            "Antonyms": [
                { type: "mcq", q: "Antonym: 'hot'?", opts: ["Cold", "Warm", "Burning", "Humid"], ans: 0, exp: "Cold ‚â† hot", diff: "A3" },
                { type: "mcq", q: "Antonym: 'ancient'?", opts: ["Modern", "Old", "Historic", "Traditional"], ans: 0, exp: "Modern ‚â† ancient", diff: "A4" },
                { type: "tf", q: "'Selfish' is the antonym of 'generous'", ans: true, exp: "Selfish ‚â† generous", diff: "M5" },
                { type: "mcq", q: "Antonym: 'temporary'?", opts: ["Permanent", "Brief", "Short", "Fleeting"], ans: 0, exp: "Permanent ‚â† temporary", diff: "M5" },
                { type: "fill", q: "Antonym of 'optimistic': p_ss_m_st_c", ans: "pessimistic", exp: "Pessimistic = negative outlook", diff: "M5" },
                { type: "mcq", q: "Antonym: 'expand'?", opts: ["Contract", "Grow", "Enlarge", "Increase"], ans: 0, exp: "Contract = shrink", diff: "M5" },
                { type: "match", q: "Match antonyms:", left: ["hot", "ancient", "expand"], right: ["modern", "cold", "contract"], ans: [[0,1], [1,0], [2,2]], exp: "hot‚Üîcold, ancient‚Üîmodern, expand‚Üîcontract", diff: "M6" },
                { type: "mcq", q: "Antonym: 'profound'?", opts: ["Superficial", "Deep", "Meaningful", "Significant"], ans: 0, exp: "Superficial = shallow", diff: "M6" },
                { type: "mcq", q: "Antonym: 'abundant'?", opts: ["Scarce", "Plentiful", "Numerous", "Ample"], ans: 0, exp: "Scarce = rare", diff: "M6" },
                { type: "tf", q: "'Malevolent' is the opposite of 'benevolent'", ans: true, exp: "Malevolent = wishing harm", diff: "M6" },
                { type: "mcq", q: "Antonym: 'brave'?", opts: ["Cowardly", "Bold", "Fearless", "Heroic"], ans: 0, exp: "Cowardly = afraid", diff: "M5" },
                { type: "multi", q: "Select ALL antonyms of 'simple':", opts: ["Complex", "Easy", "Complicated", "Basic", "Intricate"], ans: [0, 2, 4], exp: "Complex, complicated, intricate ‚â† simple", diff: "M6" },
                { type: "mcq", q: "Antonym: 'victory'?", opts: ["Defeat", "Win", "Success", "Triumph"], ans: 0, exp: "Defeat = loss", diff: "M5" },
                { type: "fill", q: "Antonym of 'remember': f_rg_t", ans: "forget", exp: "Forget ‚â† remember", diff: "A4" },
                { type: "mcq", q: "Antonym: 'increase'?", opts: ["Decrease", "Grow", "Rise", "Expand"], ans: 0, exp: "Decrease = reduce", diff: "A4" },
                { type: "mcq", q: "Antonym: 'arrive'?", opts: ["Depart", "Come", "Reach", "Enter"], ans: 0, exp: "Depart = leave", diff: "A4" }
            ],
            "Prefixes": [
                { q: "Prefix 'un-' means?", opts: ["Not", "Very", "Before", "After"], ans: 0, exp: "un- = not", diff: "A3" },
                { q: "Prefix 're-' means?", opts: ["Again", "Not", "Before", "Under"], ans: 0, exp: "re- = again", diff: "A4" },
                { q: "Prefix 'pre-' means?", opts: ["Before", "After", "Not", "Again"], ans: 0, exp: "pre- = before", diff: "A4" },
                { q: "'Unhappy' means?", opts: ["Not happy", "Very happy", "Before happy", "Happy again"], ans: 0, exp: "un- = not", diff: "A4" },
                { q: "Prefix 'dis-' means?", opts: ["Not/opposite", "Very", "With", "More"], ans: 0, exp: "dis- = opposite", diff: "M5" },
                { q: "Prefix 'mis-' means?", opts: ["Wrong", "Right", "More", "Less"], ans: 0, exp: "mis- = wrong", diff: "M5" },
                { q: "Prefix 'anti-' means?", opts: ["Against", "For", "With", "Before"], ans: 0, exp: "anti- = against", diff: "M5" },
                { q: "'Impossible' means?", opts: ["Not possible", "Very possible", "More possible", "Again possible"], ans: 0, exp: "im- = not", diff: "M5" },
                { q: "Prefix 'inter-' means?", opts: ["Between", "Within", "Outside", "Before"], ans: 0, exp: "inter- = between", diff: "M6" },
                { q: "Prefix 'trans-' means?", opts: ["Across", "Below", "Within", "Around"], ans: 0, exp: "trans- = across", diff: "M6" },
                { q: "Prefix 'sub-' means?", opts: ["Under", "Over", "Before", "After"], ans: 0, exp: "sub- = under", diff: "M5" },
                { q: "Prefix 'super-' means?", opts: ["Above/beyond", "Under", "Before", "Against"], ans: 0, exp: "super- = above", diff: "M5" },
                { q: "'Bicycle' has prefix meaning?", opts: ["Two", "One", "Three", "Many"], ans: 0, exp: "bi- = two", diff: "A4" }
            ],
            "Suffixes": [
                { q: "Suffix '-ful' means?", opts: ["Full of", "Without", "Before", "Again"], ans: 0, exp: "-ful = full of", diff: "A3" },
                { q: "Suffix '-less' means?", opts: ["Without", "Full of", "More", "Most"], ans: 0, exp: "-less = without", diff: "A4" },
                { q: "'Careful' means?", opts: ["Full of care", "Without care", "More care", "Less care"], ans: 0, exp: "-ful = full of", diff: "A4" },
                { q: "Suffix '-ly' makes?", opts: ["Adverb", "Noun", "Verb", "Adjective"], ans: 0, exp: "-ly = adverb", diff: "M5" },
                { q: "Suffix '-ness' makes?", opts: ["Noun", "Verb", "Adverb", "Adjective"], ans: 0, exp: "-ness = noun", diff: "M5" },
                { q: "Suffix '-able' means?", opts: ["Can be done", "Cannot", "Must", "Should"], ans: 0, exp: "-able = capable", diff: "M5" },
                { q: "'Happiness' is a?", opts: ["Noun", "Verb", "Adjective", "Adverb"], ans: 0, exp: "-ness = noun", diff: "M5" },
                { q: "Suffix '-tion' makes?", opts: ["Noun", "Verb", "Adjective", "Adverb"], ans: 0, exp: "-tion = noun", diff: "M6" },
                { q: "Suffix '-ify' makes?", opts: ["Verb", "Noun", "Adjective", "Adverb"], ans: 0, exp: "-ify = verb (beautify)", diff: "M6" },
                { q: "Suffix '-ment' makes?", opts: ["Noun", "Verb", "Adjective", "Adverb"], ans: 0, exp: "-ment = noun", diff: "M6" },
                { q: "Suffix '-er' often means?", opts: ["One who does", "Action", "Quality", "Place"], ans: 0, exp: "Teacher = one who teaches", diff: "A4" },
                { q: "Suffix '-ous' means?", opts: ["Full of/having", "Without", "Against", "Before"], ans: 0, exp: "Dangerous = full of danger", diff: "M5" },
                { q: "Suffix '-ist' means?", opts: ["Person who", "Action", "Quality", "Place"], ans: 0, exp: "Artist = person who does art", diff: "M5" }
            ],
            "Parts of Speech": [
                { q: "Which is a noun?", opts: ["Happiness", "Happy", "Happily", "Happier"], ans: 0, exp: "Noun = thing/concept", diff: "A4" },
                { q: "Which is a verb?", opts: ["Running", "Runner", "Run-down", "Runny"], ans: 0, exp: "Verb = action", diff: "A4" },
                { q: "Which is an adjective?", opts: ["Beautiful", "Beauty", "Beautify", "Beautifully"], ans: 0, exp: "Adjective describes noun", diff: "M5" },
                { q: "Which is an adverb?", opts: ["Quickly", "Quick", "Quicker", "Quickest"], ans: 0, exp: "Adverb modifies verb", diff: "M5" },
                { q: "'And' is a?", opts: ["Conjunction", "Noun", "Verb", "Adjective"], ans: 0, exp: "Joins words/clauses", diff: "M5" },
                { q: "'In' is a?", opts: ["Preposition", "Noun", "Verb", "Adjective"], ans: 0, exp: "Shows position", diff: "M5" },
                { q: "'She' is a?", opts: ["Pronoun", "Noun", "Verb", "Adjective"], ans: 0, exp: "Replaces noun", diff: "M5" },
                { q: "Identify verb: 'She runs fast'", opts: ["runs", "She", "fast", "None"], ans: 0, exp: "Action word", diff: "M5" },
                { q: "In 'The tall boy ran', adjective is?", opts: ["tall", "The", "boy", "ran"], ans: 0, exp: "Describes 'boy'", diff: "M6" },
                { q: "'However' is a?", opts: ["Conjunction/adverb", "Noun", "Verb", "Adjective"], ans: 0, exp: "Connects contrasting ideas", diff: "M6" },
                { q: "'Wow!' is a?", opts: ["Interjection", "Noun", "Verb", "Adverb"], ans: 0, exp: "Shows emotion", diff: "M5" },
                { q: "'The' is a?", opts: ["Article", "Noun", "Verb", "Adverb"], ans: 0, exp: "Definite article", diff: "A4" },
                { q: "In 'She sings beautifully', adverb is?", opts: ["beautifully", "She", "sings", "None"], ans: 0, exp: "Describes how", diff: "M5" }
            ],
            "Verb Tenses": [
                { q: "Past tense: 'go'?", opts: ["Went", "Goed", "Gone", "Going"], ans: 0, exp: "Irregular verb", diff: "A4" },
                { q: "Past tense: 'eat'?", opts: ["Ate", "Eated", "Eaten", "Eating"], ans: 0, exp: "Irregular verb", diff: "A4" },
                { q: "Past tense: 'play'?", opts: ["Played", "Plaied", "Play", "Playing"], ans: 0, exp: "Regular: +ed", diff: "A4" },
                { q: "Future tense: 'write'?", opts: ["Will write", "Wrote", "Written", "Writing"], ans: 0, exp: "Will + base", diff: "M5" },
                { q: "Present continuous: 'read'?", opts: ["Is reading", "Read", "Reads", "Readed"], ans: 0, exp: "Is/are + -ing", diff: "M5" },
                { q: "Past participle: 'go'?", opts: ["Gone", "Went", "Going", "Goes"], ans: 0, exp: "Have/has gone", diff: "M5" },
                { q: "Past perfect: 'eat'?", opts: ["Had eaten", "Have eaten", "Ate", "Was eating"], ans: 0, exp: "Had + past participle", diff: "M6" },
                { q: "Which is present perfect?", opts: ["I have finished", "I finished", "I am finishing", "I will finish"], ans: 0, exp: "Have/has + pp", diff: "M6" },
                { q: "Passive voice: 'The book was ___ by her'", opts: ["written", "write", "writing", "wrote"], ans: 0, exp: "Was + past participle", diff: "M6" },
                { q: "Future continuous: 'study'?", opts: ["Will be studying", "Will study", "Studies", "Studied"], ans: 0, exp: "Will be + -ing", diff: "M6" },
                { q: "Past tense: 'swim'?", opts: ["Swam", "Swimmed", "Swum", "Swimming"], ans: 0, exp: "Irregular verb", diff: "M5" },
                { q: "Past tense: 'run'?", opts: ["Ran", "Runned", "Running", "Run"], ans: 0, exp: "Irregular verb", diff: "A4" },
                { q: "Past participle: 'write'?", opts: ["Written", "Wrote", "Writing", "Writes"], ans: 0, exp: "Have/has written", diff: "M5" }
            ],
            "Sentence Structure": [
                { q: "Correct: 'She ___ like apples'", opts: ["doesn't", "don't", "not", "no"], ans: 0, exp: "doesn't with she", diff: "A4" },
                { q: "Subject: 'The cat sat on the mat'?", opts: ["The cat", "sat", "the mat", "on"], ans: 0, exp: "Who does action", diff: "A4" },
                { q: "Complete sentence?", opts: ["She runs fast.", "Running fast.", "The big dog.", "Because."], ans: 0, exp: "Subject + verb", diff: "M5" },
                { q: "'The dogs ___ barking'", opts: ["are", "is", "was", "be"], ans: 0, exp: "Plural = are", diff: "M5" },
                { q: "'Everyone ___ here'", opts: ["is", "are", "were", "be"], ans: 0, exp: "Everyone = singular", diff: "M5" },
                { q: "Which is compound sentence?", opts: ["I went and bought milk.", "Running.", "The car.", "Although."], ans: 0, exp: "Two clauses + and", diff: "M6" },
                { q: "Fix: 'Him and me went'", opts: ["He and I went", "Him and I went", "He and me went", "Correct"], ans: 0, exp: "Subject pronouns", diff: "M6" },
                { q: "Which is complex sentence?", opts: ["Although tired, she worked.", "She worked.", "She worked hard.", "Working."], ans: 0, exp: "Subordinate clause", diff: "M6" },
                { q: "Passive: 'The cake was eaten by them' ‚Üí Active?", opts: ["They ate the cake", "Cake ate them", "Eating cake", "Was eating"], ans: 0, exp: "Subject does action", diff: "M6" },
                { q: "Identify fragment:", opts: ["After the rain.", "She danced.", "I am here.", "We went."], ans: 0, exp: "Incomplete thought", diff: "M6" },
                { q: "'Neither ___ nor they know'", opts: ["he", "him", "they", "them"], ans: 0, exp: "Subject pronoun", diff: "M6" },
                { q: "Run-on sentence fix?", opts: ["Add period or conjunction", "Remove words", "Add more words", "Nothing"], ans: 0, exp: "Separate clauses", diff: "M6" },
                { q: "'Each of the students ___ ready'", opts: ["is", "are", "were", "be"], ans: 0, exp: "Each = singular", diff: "M6" }
            ],
            "Punctuation": [
                { q: "End a statement with?", opts: ["Period (.)", "Question mark", "Exclamation", "Comma"], ans: 0, exp: "Statement = period", diff: "A3" },
                { q: "Apostrophe in 'dog's bone'?", opts: ["Possession", "Plural", "Contraction", "Nothing"], ans: 0, exp: "Dog owns bone", diff: "A4" },
                { q: "'It's' means?", opts: ["It is", "Possessive its", "Plural", "Nothing"], ans: 0, exp: "Contraction", diff: "A4" },
                { q: "Comma needed: 'However __ I disagree'", opts: ["After However", "Before However", "No comma", "Both sides"], ans: 0, exp: "After conjunctive adverb", diff: "M5" },
                { q: "'They're' means?", opts: ["They are", "Their", "There", "Them"], ans: 0, exp: "Contraction", diff: "M5" },
                { q: "Use semicolon when?", opts: ["Joining related sentences", "Questions", "Lists", "Contractions"], ans: 0, exp: "Related independent clauses", diff: "M6" },
                { q: "Colon introduces?", opts: ["List or explanation", "Question", "New paragraph", "End"], ans: 0, exp: "Colon = list/explain", diff: "M6" },
                { q: "Oxford comma example?", opts: ["Red, white, and blue", "Red white blue", "Red, white blue", "Red and white and blue"], ans: 0, exp: "Comma before 'and' in list", diff: "M6" },
                { q: "Quotation marks for?", opts: ["Direct speech", "Thoughts only", "Actions", "Descriptions"], ans: 0, exp: "Exact words spoken", diff: "M5" },
                { q: "Correct: 'Its/It's raining'?", opts: ["It's", "Its", "Its'", "Itss"], ans: 0, exp: "It is = It's", diff: "M5" },
                { q: "'You're' is short for?", opts: ["You are", "Your", "Yours", "You"], ans: 0, exp: "Contraction", diff: "A4" },
                { q: "Hyphen used in?", opts: ["Compound words", "End of sentence", "Questions", "Lists"], ans: 0, exp: "Self-confident", diff: "M5" },
                { q: "Ellipsis (...) shows?", opts: ["Omission or pause", "Excitement", "Question", "Ending"], ans: 0, exp: "Something left out", diff: "M6" }
            ],
            "Writing": [
                { q: "Topic sentence purpose?", opts: ["Introduce main idea", "Conclude", "Give examples", "Cite sources"], ans: 0, exp: "Sets direction", diff: "M5" },
                { q: "Shows contrast?", opts: ["However", "Therefore", "Furthermore", "Similarly"], ans: 0, exp: "However = but", diff: "M5" },
                { q: "Shows addition?", opts: ["Furthermore", "However", "Although", "But"], ans: 0, exp: "Furthermore = also", diff: "M5" },
                { q: "Shows cause?", opts: ["Because", "Although", "But", "However"], ans: 0, exp: "Because = reason", diff: "M5" },
                { q: "Conclusion should?", opts: ["Summarize main points", "Add new ideas", "Ask questions", "Give examples"], ans: 0, exp: "Wrap up, no new", diff: "M5" },
                { q: "Writing to convince?", opts: ["Persuasive", "Narrative", "Descriptive", "Expository"], ans: 0, exp: "Persuade = convince", diff: "M5" },
                { q: "Formal writing avoids?", opts: ["Slang", "Facts", "Evidence", "Punctuation"], ans: 0, exp: "No informal language", diff: "M6" },
                { q: "Thesis statement is?", opts: ["Main argument", "Supporting detail", "Conclusion", "Introduction"], ans: 0, exp: "Central claim", diff: "M6" },
                { q: "PEEL structure: E stands for?", opts: ["Explain/Evidence", "End", "Effect", "Examine"], ans: 0, exp: "Explain then Evidence", diff: "M6" },
                { q: "Transition for time order?", opts: ["First, then, finally", "However, but", "Similarly, likewise", "Therefore, thus"], ans: 0, exp: "Sequence words", diff: "M6" },
                { q: "Narrative writing tells?", opts: ["A story", "Facts only", "How to do something", "Your opinion"], ans: 0, exp: "Story with plot", diff: "M5" },
                { q: "What is expository writing?", opts: ["Explains/informs", "Tells story", "Gives opinion", "Describes scene"], ans: 0, exp: "Information based", diff: "M6" },
                { q: "'Therefore' shows?", opts: ["Result/conclusion", "Contrast", "Addition", "Time"], ans: 0, exp: "Cause and effect", diff: "M5" }
            ],
            "Comprehension": [
                { q: "Main idea is?", opts: ["What text is mainly about", "Small detail", "Title only", "Last sentence"], ans: 0, exp: "Central message", diff: "A4" },
                { q: "'NZ is beautiful' is?", opts: ["Opinion", "Fact", "Neither", "Both"], ans: 0, exp: "Can't be proven", diff: "A4" },
                { q: "Inference is?", opts: ["Conclusion from clues", "Direct quote", "Title", "Author"], ans: 0, exp: "Reading between lines", diff: "M5" },
                { q: "Summary should be?", opts: ["Brief, main points", "Longer than original", "Include opinions", "Copy exact"], ans: 0, exp: "Short, key ideas", diff: "M5" },
                { q: "Author's purpose: inform?", opts: ["Give information", "Entertain", "Convince", "Sell"], ans: 0, exp: "Share facts", diff: "M5" },
                { q: "Context clues help find?", opts: ["Word meaning", "Author name", "Title", "Page number"], ans: 0, exp: "Unknown word meaning", diff: "M5" },
                { q: "'Ravenous' in 'ravenous wolf devoured meat'?", opts: ["Very hungry", "Angry", "Tired", "Fast"], ans: 0, exp: "Context: devoured", diff: "M6" },
                { q: "Tone of 'What a disaster!'?", opts: ["Frustrated/upset", "Happy", "Calm", "Neutral"], ans: 0, exp: "Exclamation shows feeling", diff: "M6" },
                { q: "Bias in writing means?", opts: ["One-sided view", "Neutral", "Factual", "Balanced"], ans: 0, exp: "Unfair perspective", diff: "M6" },
                { q: "Author's perspective is?", opts: ["Their viewpoint", "Character's view", "Reader's opinion", "Publisher's view"], ans: 0, exp: "Writer's position", diff: "M6" },
                { q: "Supporting details do what?", opts: ["Back up main idea", "Introduce topic", "End paragraph", "Nothing"], ans: 0, exp: "Provide evidence", diff: "M5" },
                { q: "Theme is?", opts: ["Central message/lesson", "Main character", "Setting", "Plot"], ans: 0, exp: "Deeper meaning", diff: "M6" },
                { q: "'Auckland has 1.6M people' is?", opts: ["Fact", "Opinion", "Neither", "Both"], ans: 0, exp: "Can be verified", diff: "A4" }
            ]
        }
    },
    science: {
        name: "Science", icon: "üî¨", from: "#22c55e", to: "#14b8a6", target: "M6-E7",
        topics: {
            "Atoms-Elements": [
                { type: "mcq", q: "What is an atom?", opts: ["Smallest particle of element", "Molecule", "Reaction", "Mixture"], ans: 0, exp: "Building block", diff: "A4" },
                { type: "tf", q: "Protons have a positive charge", ans: true, exp: "Protons = +", diff: "A4" },
                { type: "tf", q: "Electrons have a positive charge", ans: false, exp: "Electrons = negative", diff: "A4" },
                { type: "mcq", q: "Neutrons are?", opts: ["Neutral", "Positive", "Negative", "Both"], ans: 0, exp: "No charge", diff: "M5" },
                { type: "fill", q: "Protons and neutrons are located in the ___", ans: "nucleus", exp: "Center of atom", diff: "M5" },
                { type: "mcq", q: "Atomic number = ?", opts: ["Protons", "Neutrons", "Electrons + neutrons", "Mass"], ans: 0, exp: "Proton count", diff: "M6" },
                { type: "mcq", q: "Mass number = ?", opts: ["Protons + neutrons", "Protons only", "Electrons", "Charge"], ans: 0, exp: "P + N", diff: "M6" },
                { type: "mcq", q: "Isotopes have same?", opts: ["Protons, different neutrons", "Electrons", "Mass", "Everything"], ans: 0, exp: "Same element, diff mass", diff: "E7" },
                { type: "fill", q: "Carbon-12 has ___ neutrons", ans: "6", exp: "12-6=6 neutrons", diff: "E7" },
                { type: "mcq", q: "Electron configuration Na (11)?", opts: ["2,8,1", "2,9", "8,3", "11"], ans: 0, exp: "2 then 8 then 1", diff: "E7" },
                { type: "tf", q: "Metals are found on the left side of the periodic table", ans: true, exp: "Metals left", diff: "M5" },
                { type: "mcq", q: "Noble gases are?", opts: ["Unreactive", "Very reactive", "Metals", "Liquids"], ans: 0, exp: "Full outer shell", diff: "M6" },
                { type: "match", q: "Match particle to charge:", left: ["Proton", "Electron", "Neutron"], right: ["Negative", "Neutral", "Positive"], ans: [[0,2], [1,0], [2,1]], exp: "P=+, E=-, N=0", diff: "M5" },
                { type: "mcq", q: "Group 1 elements are?", opts: ["Alkali metals", "Halogens", "Noble gases", "Alkaline"], ans: 0, exp: "Li, Na, K...", diff: "M6" },
                { type: "fill", q: "Chlorine-37 has ___ neutrons", ans: "20", exp: "37-17=20", diff: "E7" }
            ],
            "Chemical-Formulas": [
                { q: "Water symbol?", opts: ["H‚ÇÇO", "CO‚ÇÇ", "NaCl", "O‚ÇÇ"], ans: 0, exp: "2H + 1O", diff: "A4" },
                { q: "CO‚ÇÇ is?", opts: ["Carbon dioxide", "Carbon monoxide", "Calcium oxide", "Copper oxide"], ans: 0, exp: "1 carbon, 2 oxygen", diff: "M5" },
                { q: "NaCl is?", opts: ["Salt", "Water", "Sugar", "Acid"], ans: 0, exp: "Sodium chloride", diff: "M5" },
                { q: "H‚ÇÇ means?", opts: ["2 hydrogen atoms", "Hydrogen ion", "Heavy hydrogen", "Helium"], ans: 0, exp: "Subscript = count", diff: "M5" },
                { q: "CH‚ÇÑ is?", opts: ["Methane", "Carbon dioxide", "Water", "Alcohol"], ans: 0, exp: "Natural gas", diff: "M6" },
                { q: "2H‚ÇÇO means?", opts: ["2 water molecules", "2 hydrogens", "2 oxygens", "Heavy water"], ans: 0, exp: "Coefficient", diff: "M6" },
                { q: "CO is?", opts: ["Carbon monoxide", "Carbon dioxide", "Cobalt", "Copper"], ans: 0, exp: "Poisonous gas", diff: "M6" },
                { q: "H‚ÇÇSO‚ÇÑ is?", opts: ["Sulfuric acid", "Water", "Salt", "Sugar"], ans: 0, exp: "Strong acid", diff: "E7" },
                { q: "How many atoms in H‚ÇÇSO‚ÇÑ?", opts: ["7", "4", "6", "8"], ans: 0, exp: "2+1+4=7", diff: "E7" },
                { q: "CaCO‚ÇÉ is?", opts: ["Calcium carbonate", "Carbon dioxide", "Calcium oxide", "Carbolic acid"], ans: 0, exp: "Limestone/chalk", diff: "E7" },
                { q: "NH‚ÇÉ is?", opts: ["Ammonia", "Nitrogen", "Water", "Acid"], ans: 0, exp: "N + 3H", diff: "M6" },
                { q: "Atoms in C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ?", opts: ["24", "18", "6", "12"], ans: 0, exp: "6+12+6=24", diff: "E7" },
                { q: "O‚ÇÇ is called?", opts: ["Oxygen molecule", "Ozone", "Oxide", "Oxygen atom"], ans: 0, exp: "Diatomic", diff: "M5" }
            ],
            "Chemical-Reactions": [
                { type: "mcq", q: "NOT sign of chemical reaction?", opts: ["Shape change", "Color change", "Gas production", "Heat change"], ans: 0, exp: "Shape = physical", diff: "M5" },
                { type: "tf", q: "Reactants are the starting substances in a reaction", ans: true, exp: "Before reaction", diff: "M5" },
                { type: "tf", q: "Products are formed at the end of a chemical reaction", ans: true, exp: "After reaction", diff: "M5" },
                { type: "mcq", q: "Catalyst does?", opts: ["Speeds up, not used", "Slows", "Stops", "Nothing"], ans: 0, exp: "Faster, unchanged", diff: "M6" },
                { type: "fill", q: "Burning is also called ___", ans: "combustion", exp: "Reaction with oxygen", diff: "M5" },
                { type: "mcq", q: "Rust is?", opts: ["Oxidation", "Combustion", "Neutralization", "Decomposition"], ans: 0, exp: "Iron + oxygen + water", diff: "M6" },
                { type: "match", q: "Match reaction types:", left: ["Acid + Base", "Burning", "Rust"], right: ["Combustion", "Oxidation", "Neutralization"], ans: [[0,2], [1,0], [2,1]], exp: "Acid+Base=Neutralization, Burning=Combustion, Rust=Oxidation", diff: "E7" },
                { type: "mcq", q: "Balanced equation has?", opts: ["Equal atoms each side", "More products", "More reactants", "Different elements"], ans: 0, exp: "Conservation of mass", diff: "E7" },
                { type: "tf", q: "Endothermic reactions absorb heat", ans: true, exp: "Takes in energy", diff: "E7" },
                { type: "mcq", q: "Exothermic example?", opts: ["Combustion", "Photosynthesis", "Melting ice", "Evaporation"], ans: 0, exp: "Releases heat", diff: "E7" },
                { type: "mcq", q: "HCl + NaOH ‚Üí ?", opts: ["NaCl + H‚ÇÇO", "Na + Cl‚ÇÇ", "H‚ÇÇ + O‚ÇÇ", "NaCl only"], ans: 0, exp: "Salt + water", diff: "E7" },
                { type: "mcq", q: "Decomposition reaction?", opts: ["One ‚Üí many", "Many ‚Üí one", "Exchange", "No change"], ans: 0, exp: "Breaks apart", diff: "M6" },
                { type: "mcq", q: "Synthesis reaction?", opts: ["Many ‚Üí one", "One ‚Üí many", "Exchange", "No change"], ans: 0, exp: "Combines", diff: "M6" }
            ],
            "States-Matter": [
                { type: "multi", q: "Select the three states of matter:", opts: ["Solid", "Liquid", "Gas", "Plasma", "Energy"], ans: [0, 1, 2], exp: "Basic states: solid, liquid, gas", diff: "A4" },
                { type: "fill", q: "Solid ‚Üí liquid is called ___", ans: "melting", exp: "Melting", diff: "A4" },
                { type: "fill", q: "Liquid ‚Üí gas is called ___", ans: "evaporation", exp: "Evaporation", diff: "M5" },
                { type: "fill", q: "Gas ‚Üí liquid is called ___", ans: "condensation", exp: "Condensation", diff: "M5" },
                { type: "mcq", q: "Solid ‚Üí gas directly?", opts: ["Sublimation", "Evaporation", "Melting", "Condensation"], ans: 0, exp: "Sublimation", diff: "M6" },
                { type: "tf", q: "Particles in a solid are close together and vibrating", ans: true, exp: "Fixed positions", diff: "M6" },
                { type: "mcq", q: "Particles in gas are?", opts: ["Far apart, fast", "Close packed", "Fixed", "Vibrating only"], ans: 0, exp: "Most energy", diff: "M6" },
                { type: "mcq", q: "Boiling vs evaporation?", opts: ["Boiling is throughout liquid", "Same thing", "Boiling is slower", "Evaporation needs more heat"], ans: 0, exp: "Boiling = all liquid, evaporation = surface", diff: "E7" },
                { type: "mcq", q: "Diffusion is faster in?", opts: ["Gases", "Liquids", "Solids", "Same all"], ans: 0, exp: "Particles move more freely", diff: "E7" },
                { type: "mcq", q: "Gas ‚Üí solid directly?", opts: ["Deposition", "Sublimation", "Freezing", "Condensation"], ans: 0, exp: "Reverse of sublimation", diff: "E7" },
                { type: "mcq", q: "Which has definite shape?", opts: ["Solid", "Liquid", "Gas", "All"], ans: 0, exp: "Fixed arrangement", diff: "M5" },
                { type: "mcq", q: "Plasma is?", opts: ["4th state, ionized gas", "Dense liquid", "Super solid", "Cold gas"], ans: 0, exp: "Stars, lightning", diff: "E8" }
            ],
            "Cells": [
                { type: "mcq", q: "Cell powerhouse?", opts: ["Mitochondria", "Nucleus", "Membrane", "Ribosome"], ans: 0, exp: "Makes ATP", diff: "M5" },
                { type: "mcq", q: "Nucleus function?", opts: ["Controls cell, DNA", "Energy", "Proteins", "Water"], ans: 0, exp: "Control center", diff: "M5" },
                { type: "mcq", q: "Cell membrane function?", opts: ["Controls entry/exit", "Makes energy", "Stores DNA", "Makes proteins"], ans: 0, exp: "Selective barrier", diff: "M6" },
                { type: "tf", q: "Plant cells have cell walls, animal cells do not", ans: true, exp: "Cell wall is unique to plants", diff: "M5" },
                { type: "fill", q: "Chlorophyll is found in the ___", ans: "chloroplast", exp: "Green pigment", diff: "M6" },
                { type: "fill", q: "Ribosomes make ___", ans: "proteins", exp: "Protein synthesis", diff: "M6" },
                { type: "mcq", q: "Vacuole stores?", opts: ["Water and nutrients", "DNA", "Energy", "Proteins"], ans: 0, exp: "Storage", diff: "M5" },
                { type: "mcq", q: "Cytoplasm is?", opts: ["Jelly-like substance", "Hard shell", "Nucleus", "DNA"], ans: 0, exp: "Fills cell", diff: "M5" },
                { type: "mcq", q: "DNA found in?", opts: ["Nucleus", "Mitochondria only", "Cell wall", "Vacuole"], ans: 0, exp: "Genetic material", diff: "M6" },
                { type: "match", q: "Match organelle to function:", left: ["Mitochondria", "Nucleus", "Ribosome"], right: ["Makes proteins", "Controls cell", "Makes energy"], ans: [[0,2], [1,1], [2,0]], exp: "Mito=energy, Nucleus=control, Ribo=proteins", diff: "E7" },
                { type: "tf", q: "Eukaryotes have membrane-bound organelles", ans: true, exp: "Complex cells", diff: "E7" },
                { type: "mcq", q: "Cell division for growth?", opts: ["Mitosis", "Meiosis", "Osmosis", "Diffusion"], ans: 0, exp: "Same copies", diff: "E7" },
                { type: "fill", q: "Osmosis moves ___ across membranes", ans: "water", exp: "Water diffusion", diff: "M6" }
            ],
            "Photosynthesis": [
                { q: "Plants make food by?", opts: ["Photosynthesis", "Respiration", "Digestion", "Fermentation"], ans: 0, exp: "Light+CO‚ÇÇ+H‚ÇÇO", diff: "M5" },
                { q: "Photosynthesis needs?", opts: ["Sunlight, CO‚ÇÇ, water", "Oxygen only", "Darkness", "Sugar"], ans: 0, exp: "Inputs", diff: "M5" },
                { q: "Photosynthesis produces?", opts: ["Glucose and oxygen", "CO‚ÇÇ and water", "Only oxygen", "Only glucose"], ans: 0, exp: "Outputs", diff: "M6" },
                { q: "Photosynthesis occurs in?", opts: ["Chloroplasts", "Mitochondria", "Nucleus", "Vacuole"], ans: 0, exp: "Green parts", diff: "M6" },
                { q: "Chlorophyll absorbs?", opts: ["Light energy", "Water", "Carbon dioxide", "Oxygen"], ans: 0, exp: "Sunlight", diff: "M6" },
                { q: "Word equation?", opts: ["CO‚ÇÇ+H‚ÇÇO‚Üíglucose+O‚ÇÇ", "O‚ÇÇ‚ÜíCO‚ÇÇ", "Glucose‚ÜíCO‚ÇÇ", "H‚ÇÇO‚ÜíO‚ÇÇ"], ans: 0, exp: "Reactants ‚Üí Products", diff: "E7" },
                { q: "Rate increases with?", opts: ["More light (to a point)", "Less CO‚ÇÇ", "Lower temp always", "Less water"], ans: 0, exp: "Limiting factors", diff: "E7" },
                { q: "Starch test uses?", opts: ["Iodine", "Litmus", "Benedict's", "Biuret"], ans: 0, exp: "Iodine turns blue-black", diff: "E7" },
                { q: "Why do plants need glucose?", opts: ["Energy and building", "Only storage", "Waste product", "Not needed"], ans: 0, exp: "Growth + respiration", diff: "M6" },
                { q: "Variegated leaf test shows?", opts: ["Only green parts make starch", "All parts same", "White makes more", "No difference"], ans: 0, exp: "Chlorophyll needed", diff: "E7" }
            ],
            "Respiration": [
                { q: "Respiration produces?", opts: ["Energy (ATP)", "Oxygen", "Glucose", "Sunlight"], ans: 0, exp: "Releases energy", diff: "M5" },
                { q: "Respiration uses?", opts: ["Glucose and oxygen", "CO‚ÇÇ and water", "Sunlight", "Chlorophyll"], ans: 0, exp: "Inputs", diff: "M6" },
                { q: "Respiration releases?", opts: ["CO‚ÇÇ and water", "Oxygen and glucose", "Sunlight", "Chlorophyll"], ans: 0, exp: "Waste products", diff: "M6" },
                { q: "Respiration occurs in?", opts: ["All living cells", "Leaves only", "Lungs only", "Plants only"], ans: 0, exp: "All organisms", diff: "M6" },
                { q: "Aerobic needs?", opts: ["Oxygen", "No oxygen", "Sunlight", "CO‚ÇÇ"], ans: 0, exp: "With oxygen", diff: "M6" },
                { q: "Anaerobic means?", opts: ["Without oxygen", "With oxygen", "With sunlight", "Without water"], ans: 0, exp: "No O‚ÇÇ", diff: "E7" },
                { q: "Fermentation in yeast produces?", opts: ["Ethanol and CO‚ÇÇ", "Lactic acid", "Water", "Oxygen"], ans: 0, exp: "Alcohol + gas", diff: "E7" },
                { q: "Muscle anaerobic produces?", opts: ["Lactic acid", "Ethanol", "Oxygen", "Glucose"], ans: 0, exp: "Causes cramps", diff: "E7" },
                { q: "Where in cell does aerobic occur?", opts: ["Mitochondria", "Nucleus", "Cell wall", "Vacuole"], ans: 0, exp: "Powerhouse", diff: "E7" },
                { q: "Which releases more energy?", opts: ["Aerobic", "Anaerobic", "Same", "Neither"], ans: 0, exp: "With oxygen = more ATP", diff: "E7" }
            ],
            "Ecosystems": [
                { q: "Ecosystem is?", opts: ["Living things + environment", "Only animals", "Only plants", "Just rocks"], ans: 0, exp: "Biotic + abiotic", diff: "M5" },
                { q: "Producer example?", opts: ["Plants", "Lions", "Humans", "Fungi"], ans: 0, exp: "Makes own food", diff: "M5" },
                { q: "Consumer example?", opts: ["Animals", "Plants", "Sunlight", "Water"], ans: 0, exp: "Eats others", diff: "M5" },
                { q: "Decomposer example?", opts: ["Fungi/bacteria", "Lion", "Tree", "Fish"], ans: 0, exp: "Breaks down dead", diff: "M6" },
                { q: "Herbivore eats?", opts: ["Plants", "Meat", "Both", "Nothing"], ans: 0, exp: "Plant eater", diff: "M5" },
                { q: "Food chain starts with?", opts: ["Producer", "Consumer", "Decomposer", "Predator"], ans: 0, exp: "Plants first", diff: "M6" },
                { q: "Energy transfer between levels?", opts: ["About 10%", "100%", "50%", "90%"], ans: 0, exp: "10% rule", diff: "E7" },
                { q: "Pyramid of energy shows?", opts: ["Energy decreases up", "Energy increases", "Equal all levels", "No pattern"], ans: 0, exp: "Less energy higher up", diff: "E7" },
                { q: "Biodiversity means?", opts: ["Variety of species", "One species", "No life", "Only plants"], ans: 0, exp: "Species variety", diff: "M6" },
                { q: "Carnivore eats?", opts: ["Meat", "Plants", "Both", "Sunlight"], ans: 0, exp: "Meat eater", diff: "M5" },
                { q: "Omnivore eats?", opts: ["Plants and meat", "Only plants", "Only meat", "Nothing"], ans: 0, exp: "Both", diff: "M5" },
                { q: "Apex predator?", opts: ["Top of food chain", "Bottom", "Middle", "Producer"], ans: 0, exp: "No natural predators", diff: "M6" },
                { q: "Carbon cycle involves?", opts: ["Photosynthesis & respiration", "Only water", "Only rocks", "Nothing"], ans: 0, exp: "Carbon movement", diff: "E7" }
            ],
            "Forces": [
                { q: "Force unit?", opts: ["Newton", "Joule", "Watt", "Metre"], ans: 0, exp: "N", diff: "A4" },
                { q: "Gravity pulls?", opts: ["Downward", "Upward", "Sideways", "Nowhere"], ans: 0, exp: "Toward Earth", diff: "A4" },
                { q: "Friction?", opts: ["Opposes motion", "Helps motion", "Creates heat only", "Nothing"], ans: 0, exp: "Slows down", diff: "M5" },
                { q: "Balanced forces result?", opts: ["No change in motion", "Acceleration", "Deceleration", "Spinning"], ans: 0, exp: "Stays same", diff: "M5" },
                { q: "Mass in?", opts: ["Kilograms", "Newtons", "Metres", "Seconds"], ans: 0, exp: "kg", diff: "M5" },
                { q: "Weight in?", opts: ["Newtons", "Kilograms", "Metres", "Litres"], ans: 0, exp: "Force = N", diff: "M6" },
                { q: "Weight = ?", opts: ["Mass √ó gravity", "Mass √∑ gravity", "Mass + gravity", "Mass only"], ans: 0, exp: "W = mg", diff: "M6" },
                { q: "Unbalanced forces cause?", opts: ["Acceleration", "Constant speed", "Rest", "Nothing"], ans: 0, exp: "Change in motion", diff: "M6" },
                { q: "Newton's 1st law?", opts: ["Object stays at rest/motion unless force", "F=ma", "Action-reaction", "Gravity"], ans: 0, exp: "Inertia", diff: "E7" },
                { q: "Newton's 2nd: F=?", opts: ["ma", "mv", "mg", "m/a"], ans: 0, exp: "Force = mass √ó acceleration", diff: "E7" },
                { q: "Newton's 3rd law?", opts: ["Action = reaction", "F=ma", "Inertia", "Gravity"], ans: 0, exp: "Equal opposite forces", diff: "E7" },
                { q: "Air resistance is?", opts: ["Friction with air", "Gravity", "Weight", "Mass"], ans: 0, exp: "Drag force", diff: "M6" },
                { q: "Terminal velocity?", opts: ["Constant falling speed", "Maximum speed ever", "Zero speed", "Acceleration"], ans: 0, exp: "Drag = weight", diff: "E7" }
            ],
            "Energy": [
                { q: "Moving object has?", opts: ["Kinetic", "Potential", "Chemical", "Nuclear"], ans: 0, exp: "Motion energy", diff: "M5" },
                { q: "Stored energy?", opts: ["Potential", "Kinetic", "Thermal", "Sound"], ans: 0, exp: "Stored", diff: "M5" },
                { q: "Energy cannot be?", opts: ["Created or destroyed", "Stored", "Changed", "Measured"], ans: 0, exp: "Conservation", diff: "M6" },
                { q: "Battery stores?", opts: ["Chemical", "Kinetic", "Sound", "Light"], ans: 0, exp: "Chemical‚Üíelectrical", diff: "M6" },
                { q: "Stretched spring has?", opts: ["Elastic potential", "Kinetic", "Chemical", "Nuclear"], ans: 0, exp: "Stored in stretch", diff: "M6" },
                { q: "Object at height has?", opts: ["Gravitational potential", "Kinetic", "Chemical", "Thermal"], ans: 0, exp: "Height = PE", diff: "M6" },
                { q: "KE formula?", opts: ["¬Ωmv¬≤", "mgh", "mv", "ma"], ans: 0, exp: "Kinetic energy", diff: "E7" },
                { q: "GPE formula?", opts: ["mgh", "¬Ωmv¬≤", "mv", "ma"], ans: 0, exp: "Gravitational PE", diff: "E7" },
                { q: "Power unit?", opts: ["Watt", "Joule", "Newton", "Kilogram"], ans: 0, exp: "W = J/s", diff: "E7" },
                { q: "Efficiency = ?", opts: ["Useful output / Total input", "Input / Output", "Total / Useful", "1"], ans: 0, exp: "As percentage", diff: "E7" },
                { q: "Energy unit?", opts: ["Joule", "Newton", "Watt", "Kilogram"], ans: 0, exp: "J", diff: "M5" },
                { q: "Work = ?", opts: ["Force √ó distance", "Mass √ó velocity", "Energy √ó time", "Power √ó mass"], ans: 0, exp: "W = Fd", diff: "E7" },
                { q: "Power = ?", opts: ["Energy √∑ time", "Force √ó time", "Mass √ó speed", "Work √ó distance"], ans: 0, exp: "P = E/t", diff: "E8" }
            ],
            "Light-Sound": [
                { q: "Light travels in?", opts: ["Straight lines", "Curves", "Circles", "Zigzags"], ans: 0, exp: "Light straight", diff: "A4" },
                { q: "Sound needs ___ to travel?", opts: ["A medium", "Nothing", "Light", "Electricity"], ans: 0, exp: "Needs particles", diff: "M5" },
                { q: "Prism separates light into?", opts: ["Spectrum", "Brighter", "Disappears", "Laser"], ans: 0, exp: "ROYGBIV", diff: "M6" },
                { q: "Sound fastest in?", opts: ["Solids", "Liquids", "Gases", "Vacuum"], ans: 0, exp: "Densest = fastest", diff: "M6" },
                { q: "Light fastest in?", opts: ["Vacuum", "Water", "Glass", "Air"], ans: 0, exp: "Nothing to slow", diff: "M6" },
                { q: "Reflection?", opts: ["Light bouncing", "Light absorbed", "Light disappearing", "Light bending"], ans: 0, exp: "Bounces off", diff: "M5" },
                { q: "Refraction?", opts: ["Light bending", "Light bouncing", "Light stopping", "Light absorbed"], ans: 0, exp: "Bends at boundary", diff: "M6" },
                { q: "Frequency affects?", opts: ["Pitch", "Volume", "Speed", "Color only"], ans: 0, exp: "High freq = high pitch", diff: "E7" },
                { q: "Amplitude affects?", opts: ["Volume/loudness", "Pitch", "Color", "Speed"], ans: 0, exp: "Bigger = louder", diff: "E7" },
                { q: "Total internal reflection needs?", opts: ["Angle > critical angle", "Any angle", "0 degrees", "90 degrees"], ans: 0, exp: "Beyond critical angle", diff: "E7" },
                { q: "Speed of light approx?", opts: ["300,000 km/s", "300 km/s", "300 m/s", "3000 km/s"], ans: 0, exp: "3√ó10‚Å∏ m/s", diff: "M6" },
                { q: "Sound cannot travel in?", opts: ["Vacuum", "Air", "Water", "Steel"], ans: 0, exp: "Needs medium", diff: "M5" },
                { q: "Echo is?", opts: ["Reflected sound", "Absorbed sound", "Fast sound", "Slow sound"], ans: 0, exp: "Sound bounce", diff: "M5" }
            ]
        }
    },
    social: {
        name: "Social Science", icon: "üåè", from: "#f97316", to: "#ef4444", target: "M5-M6",
        topics: {
            "Treaty": [
                { type: "fill", q: "The Treaty of Waitangi was signed in ___", ans: "1840", exp: "6 Feb 1840", diff: "A4" },
                { type: "mcq", q: "Waitangi Day?", opts: ["6 February", "25 December", "1 January", "26 January"], ans: 0, exp: "Treaty anniversary", diff: "A4" },
                { type: "multi", q: "Select ALL Treaty principles:", opts: ["Partnership", "Punishment", "Protection", "Participation", "Profit"], ans: [0, 2, 3], exp: "The 3 P's: Partnership, Protection, Participation", diff: "M5" },
                { type: "mcq", q: "Who signed for British?", opts: ["Captain Hobson", "Captain Cook", "Queen Victoria", "King George"], ans: 0, exp: "William Hobson", diff: "M5" },
                { type: "tf", q: "The Treaty was written in English and MƒÅori", ans: true, exp: "Both languages", diff: "M5" },
                { type: "match", q: "Match Treaty articles:", left: ["Article 1", "Article 2", "Article 3"], right: ["Property/taonga", "Equal rights", "Sovereignty"], ans: [[0,2], [1,0], [2,1]], exp: "Art1=Sovereignty, Art2=Taonga, Art3=Rights", diff: "M6" },
                { type: "mcq", q: "Article 2 about?", opts: ["Property/taonga", "Sovereignty", "Citizenship", "Laws"], ans: 0, exp: "MƒÅori keep taonga", diff: "M6" },
                { type: "mcq", q: "Article 3 about?", opts: ["Equal rights", "Land only", "Chiefs only", "Trade"], ans: 0, exp: "Citizenship", diff: "M6" },
                { type: "mcq", q: "Kawanatanga vs Rangatiratanga?", opts: ["Governance vs Chieftainship", "Same meaning", "Both mean land", "Both mean power"], ans: 0, exp: "Key translation difference", diff: "M6" },
                { type: "mcq", q: "Waitangi Tribunal?", opts: ["Investigates Treaty breaches", "Makes laws", "Signs treaties", "Elects PM"], ans: 0, exp: "Since 1975", diff: "M6" },
                { type: "fill", q: "The Treaty was signed at ___", ans: "waitangi", exp: "Bay of Islands", diff: "M5" },
                { type: "mcq", q: "How many chiefs signed first day?", opts: ["About 40", "About 500", "Just 1", "None"], ans: 0, exp: "~40 chiefs", diff: "M6" },
                { type: "tf", q: "Taonga means treasures or valued things", ans: true, exp: "Prized possessions", diff: "M5" }
            ],
            "NZ-History": [
                { q: "First NZ settlers?", opts: ["MƒÅori", "British", "Dutch", "Australian"], ans: 0, exp: "Polynesian ~1300AD", diff: "A4" },
                { q: "First European to see NZ?", opts: ["Abel Tasman", "James Cook", "Hobson", "Hillary"], ans: 0, exp: "Dutch 1642", diff: "M5" },
                { q: "James Cook arrived?", opts: ["1769", "1642", "1840", "1900"], ans: 0, exp: "British explorer", diff: "M5" },
                { q: "Women's suffrage NZ?", opts: ["1893", "1920", "1900", "1850"], ans: 0, exp: "First country!", diff: "M5" },
                { q: "NZ became dominion?", opts: ["1907", "1840", "1776", "1950"], ans: 0, exp: "More independence", diff: "M6" },
                { q: "Land Wars about?", opts: ["Land disputes", "Religion", "Trade", "Language"], ans: 0, exp: "MƒÅori-settler conflict", diff: "M6" },
                { q: "MƒÅori came from?", opts: ["Polynesia", "Australia", "Asia", "Europe"], ans: 0, exp: "Pacific islands", diff: "M5" },
                { q: "Aotearoa means?", opts: ["Land of long white cloud", "New Zealand", "Green land", "Big island"], ans: 0, exp: "MƒÅori name", diff: "M5" },
                { q: "Treaty settlements are?", opts: ["Compensation for breaches", "New treaties", "Land sales", "Government grants"], ans: 0, exp: "Addressing past wrongs", diff: "M6" },
                { q: "Kate Sheppard known for?", opts: ["Women's suffrage", "Treaty signing", "First PM", "Explorer"], ans: 0, exp: "Voting rights", diff: "M5" },
                { q: "NZ in ANZAC stands for?", opts: ["New Zealand", "North Zone", "Naval Zone", "Nothing"], ans: 0, exp: "Australia NZ Army Corps", diff: "M5" },
                { q: "Gallipoli campaign was?", opts: ["WWI battle", "WWII battle", "Land war", "Trade route"], ans: 0, exp: "1915 Turkey", diff: "M6" }
            ],
            "Geography": [
                { q: "NZ earthquakes from?", opts: ["Tectonic plates", "Volcanoes only", "Wind", "Rain"], ans: 0, exp: "Pacific+Australian", diff: "M5" },
                { q: "Sustainability means?", opts: ["Meet needs, protect future", "Use quickly", "Ignore problems", "Build more"], ans: 0, exp: "Future generations", diff: "M5" },
                { q: "Climate change cause?", opts: ["Greenhouse gases", "Moon", "Volcanoes only", "Oceans only"], ans: 0, exp: "Human CO‚ÇÇ", diff: "M5" },
                { q: "Water cycle?", opts: ["Water moving through environment", "Drinking water", "Ocean waves", "Rivers only"], ans: 0, exp: "Evap‚Üícondense‚Üíprecip", diff: "M5" },
                { q: "Renewable energy?", opts: ["Solar", "Coal", "Oil", "Gas"], ans: 0, exp: "Won't run out", diff: "M5" },
                { q: "Non-renewable?", opts: ["Coal", "Solar", "Wind", "Hydro"], ans: 0, exp: "Will run out", diff: "M5" },
                { q: "Capital of NZ?", opts: ["Wellington", "Auckland", "Christchurch", "Hamilton"], ans: 0, exp: "Wellington", diff: "A4" },
                { q: "Largest city?", opts: ["Auckland", "Wellington", "Christchurch", "Hamilton"], ans: 0, exp: "By population", diff: "A4" },
                { q: "Alpine Fault?", opts: ["Major fault line", "Mountain", "River", "Lake"], ans: 0, exp: "Earthquake risk", diff: "M6" },
                { q: "Greenhouse effect?", opts: ["Gases trap heat", "Plants grow", "Ozone hole", "Ice melts"], ans: 0, exp: "Warming", diff: "M6" },
                { q: "Geothermal energy from?", opts: ["Earth's heat", "Sun", "Wind", "Water"], ans: 0, exp: "Underground heat", diff: "M6" },
                { q: "NZ in which hemisphere?", opts: ["Southern", "Northern", "Both", "Neither"], ans: 0, exp: "South of equator", diff: "A4" },
                { q: "Deforestation causes?", opts: ["Habitat loss, erosion", "More rain", "Cooler temps", "More animals"], ans: 0, exp: "Environmental damage", diff: "M6" }
            ],
            "Government": [
                { q: "NZ government type?", opts: ["Parliamentary democracy", "Presidential", "Monarchy", "Dictatorship"], ans: 0, exp: "Elected parliament", diff: "M5" },
                { q: "Voting age?", opts: ["18", "16", "21", "25"], ans: 0, exp: "18 years", diff: "A4" },
                { q: "Head of government?", opts: ["Prime Minister", "President", "King", "Governor"], ans: 0, exp: "PM leads", diff: "M5" },
                { q: "Parliament has ___ MPs?", opts: ["120", "100", "200", "50"], ans: 0, exp: "120 members", diff: "M5" },
                { q: "MMP stands for?", opts: ["Mixed Member Proportional", "Multiple Member Parliament", "Main Member Party", "Most Members Participate"], ans: 0, exp: "Voting system", diff: "M6" },
                { q: "How many MMP votes?", opts: ["2", "1", "3", "4"], ans: 0, exp: "Electorate + party", diff: "M6" },
                { q: "Electorate vote for?", opts: ["Local MP", "Party", "PM", "President"], ans: 0, exp: "Your area's MP", diff: "M6" },
                { q: "Party vote decides?", opts: ["Parliament seats", "Local MP", "PM directly", "Laws"], ans: 0, exp: "Proportional seats", diff: "M6" },
                { q: "Election every?", opts: ["3 years", "4 years", "5 years", "2 years"], ans: 0, exp: "3 year term", diff: "M5" },
                { q: "What is a bill?", opts: ["Proposed law", "Existing law", "Court case", "Vote"], ans: 0, exp: "Before becoming Act", diff: "M6" },
                { q: "Head of state in NZ?", opts: ["King/Queen (via GG)", "Prime Minister", "President", "Mayor"], ans: 0, exp: "Constitutional monarchy", diff: "M6" },
                { q: "Local government?", opts: ["Councils", "Parliament", "Courts", "Police"], ans: 0, exp: "Regional/city councils", diff: "M5" },
                { q: "What does GG stand for?", opts: ["Governor-General", "Government Guide", "General Governor", "Grand Governor"], ans: 0, exp: "Crown representative", diff: "M6" }
            ],
            "Rights": [
                { q: "Human rights include?", opts: ["Freedom of speech", "Right to harm", "Unlimited power", "No responsibilities"], ans: 0, exp: "Basic freedoms", diff: "M5" },
                { q: "Citizen responsibility?", opts: ["Obeying laws", "Ignoring rules", "Avoiding taxes", "Breaking rules"], ans: 0, exp: "Follow law", diff: "M5" },
                { q: "Right to vote is?", opts: ["Democratic right", "Optional", "For some only", "Not a right"], ans: 0, exp: "Key democracy", diff: "M5" },
                { q: "Discrimination is?", opts: ["Treating unfairly", "Fair treatment", "Equal rights", "Nothing"], ans: 0, exp: "Unequal treatment", diff: "M5" },
                { q: "Diversity means?", opts: ["Variety of people", "Same people", "One culture", "No differences"], ans: 0, exp: "Differences valued", diff: "M5" },
                { q: "NZ Bill of Rights protects?", opts: ["Fundamental freedoms", "Property only", "Voting only", "Nothing"], ans: 0, exp: "Core rights", diff: "M6" },
                { q: "Freedom of expression?", opts: ["Share opinions", "Say anything harmful", "No limits", "No responsibility"], ans: 0, exp: "Voice views", diff: "M6" },
                { q: "Te Tiriti guarantees MƒÅori?", opts: ["Protection of taonga", "No rights", "Only land", "Nothing"], ans: 0, exp: "Article 2 rights", diff: "M6" },
                { q: "What is prejudice?", opts: ["Pre-judging without facts", "Fair judgment", "Legal term", "Nothing"], ans: 0, exp: "Unfair bias", diff: "M5" },
                { q: "What is tolerance?", opts: ["Accepting differences", "Ignoring others", "Agreement", "Sameness"], ans: 0, exp: "Respect for diversity", diff: "M5" },
                { q: "Active citizenship means?", opts: ["Participating in community", "Just voting", "Paying taxes only", "Nothing"], ans: 0, exp: "Engaged involvement", diff: "M6" },
                { q: "What is democracy?", opts: ["Rule by the people", "Rule by one", "Rule by military", "No rules"], ans: 0, exp: "People have power", diff: "M5" },
                { q: "Why are rights important?", opts: ["Protect individuals", "Create chaos", "Limit freedom", "None"], ans: 0, exp: "Safeguard freedoms", diff: "M5" }
            ]
        }
    }
};

// ============ DIFFICULTY COLORS ============
const diffColors = { A3: "#ef4444", A4: "#f97316", M5: "#eab308", M6: "#22c55e", E7: "#3b82f6", E8: "#8b5cf6" };
const diffLabels = { A3: "Achieved 3", A4: "Achieved 4", M5: "Merit 5", M6: "Merit 6", E7: "Excellence 7", E8: "Excellence 8" };

// ============ QUESTION TYPES ============
const qTypes = {
    mcq: { name: "Multiple Choice", icon: "üîò", color: "#3b82f6", desc: "Select one correct answer" },
    fill: { name: "Fill in Blank", icon: "‚úèÔ∏è", color: "#22c55e", desc: "Type the answer" },
    tf: { name: "True/False", icon: "‚öñÔ∏è", color: "#f97316", desc: "Is the statement true or false?" },
    multi: { name: "Multi-Select", icon: "‚òëÔ∏è", color: "#8b5cf6", desc: "Select ALL correct answers" },
    match: { name: "Matching", icon: "üîó", color: "#ec4899", desc: "Match pairs together" },
    short: { name: "Short Answer", icon: "üìù", color: "#14b8a6", desc: "Write a brief answer" }
};

// ============ GRADES ============
const grades = { N0: { min: 0, max: 9, label: "Not Achieved", color: "#ef4444", emoji: "üòî" }, N1: { min: 10, max: 19, label: "Not Achieved", color: "#ef4444", emoji: "üòï" }, N2: { min: 20, max: 39, label: "Not Achieved", color: "#f97316", emoji: "ü§î" }, A3: { min: 40, max: 49, label: "Achieved", color: "#eab308", emoji: "üòä" }, A4: { min: 50, max: 59, label: "Achieved", color: "#84cc16", emoji: "üôÇ" }, M5: { min: 60, max: 69, label: "Merit", color: "#22c55e", emoji: "üòÑ" }, M6: { min: 70, max: 79, label: "Merit", color: "#14b8a6", emoji: "üòÉ" }, E7: { min: 80, max: 89, label: "Excellence", color: "#3b82f6", emoji: "üåü" }, E8: { min: 90, max: 100, label: "Excellence", color: "#8b5cf6", emoji: "üèÜ" } };
function getGrade(p) { for (const [g, d] of Object.entries(grades)) if (p >= d.min && p <= d.max) return { grade: g, ...d }; return { grade: "N0", ...grades.N0 }; }

// ============ STATS FUNCTIONS ============
function getQuestionStats() {
    const stats = { 
        total: 0, 
        bySubject: {}, 
        byDiff: { A3: 0, A4: 0, M5: 0, M6: 0, E7: 0, E8: 0 }, 
        byType: { mcq: 0, fill: 0, tf: 0, multi: 0, match: 0, short: 0 },
        byTopic: {} 
    };
    Object.entries(questions).forEach(([subKey, sub]) => {
        stats.bySubject[subKey] = { total: 0, topics: {}, diff: { A3: 0, A4: 0, M5: 0, M6: 0, E7: 0, E8: 0 }, type: { mcq: 0, fill: 0, tf: 0, multi: 0, match: 0, short: 0 } };
        Object.entries(sub.topics).forEach(([topic, qs]) => {
            stats.bySubject[subKey].topics[topic] = { total: qs.length, diff: {}, type: {} };
            qs.forEach(q => {
                const qType = q.type || 'mcq';
                stats.total++;
                stats.bySubject[subKey].total++;
                stats.byDiff[q.diff] = (stats.byDiff[q.diff] || 0) + 1;
                stats.byType[qType] = (stats.byType[qType] || 0) + 1;
                stats.bySubject[subKey].diff[q.diff] = (stats.bySubject[subKey].diff[q.diff] || 0) + 1;
                stats.bySubject[subKey].type[qType] = (stats.bySubject[subKey].type[qType] || 0) + 1;
                stats.bySubject[subKey].topics[topic].diff[q.diff] = (stats.bySubject[subKey].topics[topic].diff[q.diff] || 0) + 1;
                stats.bySubject[subKey].topics[topic].type[qType] = (stats.bySubject[subKey].topics[topic].type[qType] || 0) + 1;
            });
        });
    });
    return stats;
}

// ============ STATE ============
let state = JSON.parse(localStorage.getItem('rangiData') || 'null') || { name: '', xp: 0, streak: 0, exams: 0, perfect: 0, excellence: 0, fastExams: 0, subjects: { math: 0, english: 0, science: 0, social: 0 }, history: [], badges: [], lastStudyDate: null, dailyProgress: {} };
let view = 'welcome', currentExam = null, examState = { q: 0, answers: [], selected: null }, showSyncModal = false, syncTab = 'export', syncMessage = null, newBadges = [], selectedDay = null, showReview = false;

// ============ HELPERS ============
function getTodayStr() { return new Date().toISOString().split('T')[0]; }
function getDayProgress(d) { return state.dailyProgress[d] || { exams: 0, completed: false }; }
function getDayPlan(d) { return dailyPlan.find(x => x.date === d); }
function getCurrentWeek() { const diff = Math.floor((new Date() - PLAN_START) / 864e5); return Math.max(1, Math.min(6, Math.floor(diff / 7) + 1)); }
function getOverallProgress() { let g = 0, d = 0; const t = getTodayStr(); dailyPlan.forEach(day => { if (day.date <= t) { g += day.goal; d += Math.min(getDayProgress(day.date).exams, day.goal); } }); return g > 0 ? Math.round((d / g) * 100) : 0; }
function getWeekProgress(w) { const days = dailyPlan.filter(d => d.week === w); let g = 0, done = 0; const t = getTodayStr(); days.forEach(day => { if (day.date <= t) { g += day.goal; done += Math.min(getDayProgress(day.date).exams, day.goal); } }); return g > 0 ? Math.round((done / g) * 100) : 0; }
function updateStreak() { const today = new Date().toDateString(), last = state.lastStudyDate ? new Date(state.lastStudyDate).toDateString() : null; if (last === today) return; const y = new Date(); y.setDate(y.getDate() - 1); if (last === y.toDateString()) state.streak++; else state.streak = 1; state.lastStudyDate = new Date().toISOString(); }
function updateDailyProgress() { const t = getTodayStr(), p = getDayPlan(t); if (!state.dailyProgress[t]) state.dailyProgress[t] = { exams: 0, completed: false }; state.dailyProgress[t].exams++; if (p && state.dailyProgress[t].exams >= p.goal) state.dailyProgress[t].completed = true; }
function checkBadges() { newBadges = []; for (const [id, b] of Object.entries(badgesDef)) { if (!state.badges.includes(id) && b.check(state)) { state.badges.push(id); newBadges.push(id); } } return newBadges; }
function save() { localStorage.setItem('rangiData', JSON.stringify(state)); }
function downloadData() { const b = new Blob([JSON.stringify(state, null, 2)], { type: 'application/json' }); const a = document.createElement('a'); a.href = URL.createObjectURL(b); a.download = `rangitoto-backup-${getTodayStr()}.json`; a.click(); syncMessage = { type: 'success', text: '‚úÖ Downloaded!' }; render(); }
function importData() { const t = document.getElementById('importData'); if (t?.value.trim()) { try { const i = JSON.parse(t.value.trim()); if (i.name) { state = { ...state, ...i }; if (!state.dailyProgress) state.dailyProgress = {}; save(); syncMessage = { type: 'success', text: '‚úÖ Imported!' }; showSyncModal = false; render(); } } catch (e) { syncMessage = { type: 'error', text: '‚ùå Error' }; render(); } } }
function handleFileUpload(e) { const f = e.target.files[0]; if (f) { const r = new FileReader(); r.onload = e => { document.getElementById('importData').value = e.target.result; }; r.readAsText(f); } }

// ============ RENDER ============
function render() { const app = document.getElementById('app'), stats = getQuestionStats(); let h = ''; if (showSyncModal) h += syncModalHTML(); if (!state.name) h += welcomeHTML(stats); else if (showReview) h += reviewHTML(); else if (currentExam) h += examHTML(); else if (selectedDay) h += dayDetailHTML(); else h += mainHTML(stats); app.innerHTML = h; }

function welcomeHTML(stats) { return `<div class="glass text-center bounce-in" style="max-width:500px;margin:50px auto;"><div class="text-6xl mb-4 floating">üéì</div><h1 class="text-4xl font-bold mb-4">Rangitoto</h1><h2 class="text-2xl text-purple mb-4">Year 9 Review Hub</h2><p class="text-gray mb-2">6-Week Summer Study Plan</p><p class="text-sm text-gray mb-4">Dec 6, 2025 - Jan 17, 2026</p><p class="text-xl font-bold text-yellow mb-6">üìö ${stats.total} Questions</p><input class="input" type="text" id="nameInput" placeholder="Enter your name..."><button class="btn" onclick="startApp()">Start Learning! üöÄ</button><div style="border-top:1px solid rgba(255,255,255,0.2);padding-top:20px;margin-top:20px;"><button class="btn btn-secondary" onclick="showSyncModal=true;syncTab='import';render()">üìÇ Import Backup</button></div></div>`; }
function syncModalHTML() { return `<div class="modal-overlay" onclick="if(event.target===this){showSyncModal=false;syncMessage=null;render();}"><div class="modal"><h2 class="text-2xl font-bold mb-4">üíæ Backup</h2><div class="tabs"><button class="tab ${syncTab === 'export' ? 'active' : ''}" onclick="syncTab='export';render()">üì§ Export</button><button class="tab ${syncTab === 'import' ? 'active' : ''}" onclick="syncTab='import';render()">üì• Import</button></div>${syncMessage ? `<div class="alert alert-${syncMessage.type === 'success' ? 'success' : 'warning'}">${syncMessage.text}</div>` : ''}${syncTab === 'export' ? `<button class="btn btn-green" onclick="downloadData()">üì• Download</button>` : `<input type="file" accept=".json" onchange="handleFileUpload(event)" class="input"><textarea class="input" id="importData" placeholder="Or paste..."></textarea><button class="btn btn-orange" onclick="importData()">üì• Import</button>`}<button class="btn btn-secondary mt-4" onclick="showSyncModal=false;syncMessage=null;render()">Close</button></div></div>`; }
function startApp() { const n = document.getElementById('nameInput').value.trim(); if (n) { state.name = n; if (!state.dailyProgress) state.dailyProgress = {}; save(); render(); } }

function mainHTML(stats) { const h = Math.min(100, Math.round((state.exams / 3) * 80 + state.streak * 3)), hc = h >= 60 ? 'health-good' : h >= 30 ? 'health-warning' : 'health-danger'; return `<div class="header"><div class="flex items-center gap-4"><span class="text-4xl floating">üéì</span><div><h1 class="text-xl font-bold">Kia ora, ${state.name}!</h1><span class="text-yellow">‚ö° ${state.xp} XP</span>${state.streak > 0 ? `<span class="text-gray"> | üî• ${state.streak}</span>` : ''}</div></div><div class="flex gap-2 items-center"><button class="btn btn-small btn-secondary" onclick="showSyncModal=true;syncTab='export';render()">üíæ</button><div class="health-bar ${hc}">${h}%</div></div></div><div class="nav"><button class="nav-btn ${view === 'dashboard' ? 'active' : ''}" onclick="setView('dashboard')">üè† Home</button><button class="nav-btn ${view === 'plan' ? 'active' : ''}" onclick="setView('plan')">üìÖ Plan</button><button class="nav-btn ${view === 'subjects' ? 'active' : ''}" onclick="setView('subjects')">üìö Subjects</button><button class="nav-btn ${view === 'qbank' ? 'active' : ''}" onclick="setView('qbank')">üìä Q-Bank</button><button class="nav-btn ${view === 'badges' ? 'active' : ''}" onclick="setView('badges')">üèÖ Badges</button><button class="nav-btn ${view === 'stats' ? 'active' : ''}" onclick="setView('stats')">üìà Stats</button></div>${view === 'dashboard' ? dashboardHTML(stats) : view === 'plan' ? planHTML() : view === 'subjects' ? subjectsHTML(stats) : view === 'qbank' ? qbankHTML(stats) : view === 'badges' ? badgesHTML() : statsHTML()}`; }
function setView(v) { view = v; render(); }

function dashboardHTML(stats) { const t = getTodayStr(), tp = getDayPlan(t), pr = getDayProgress(t), op = getOverallProgress(); return `${tp ? `<div class="glass" style="background:linear-gradient(135deg, ${tp.weekPlan.color.from}22, ${tp.weekPlan.color.to}22)"><div class="flex justify-between items-center mb-4"><div class="flex items-center gap-3"><span style="font-size:40px">${tp.icon}</span><div><h2 class="text-xl font-bold">Today's Focus</h2><p class="text-gray">${tp.isRest ? 'Rest Day! üéâ' : tp.topic}</p></div></div><div class="text-center"><div class="text-3xl font-bold">${pr.exams}/${tp.goal}</div></div></div>${!tp.isRest ? `<div class="progress-bar mb-4"><div class="progress-fill ${pr.completed ? 'green' : ''}" style="width:${Math.min(100, (pr.exams / tp.goal) * 100)}%"></div></div>${!pr.completed ? `<button class="btn btn-green" onclick="startDayTask('${t}')">üöÄ Study Now</button>` : `<p class="text-green font-bold text-center">‚úÖ Done!</p>`}` : ''}</div>` : ''}<div class="glass"><div class="flex justify-between items-center mb-4"><h2 class="text-xl font-bold">üìÖ 6-Week Progress</h2><span class="font-bold">${op}%</span></div><div class="progress-bar mb-4"><div class="progress-fill green" style="width:${op}%"></div></div><button class="btn btn-small btn-secondary" onclick="setView('plan')">View Plan ‚Üí</button></div><div class="grid grid-4 gap-3 mb-4"><div class="stat-card"><div class="stat-num text-yellow">‚ö°${state.xp}</div><div class="stat-label">XP</div></div><div class="stat-card"><div class="stat-num text-green">‚úÖ${state.exams}</div><div class="stat-label">Exams</div></div><div class="stat-card"><div class="stat-num" style="color:#f97316">üî•${state.streak}</div><div class="stat-label">Streak</div></div><div class="stat-card"><div class="stat-num text-purple">üèÖ${state.badges.length}</div><div class="stat-label">Badges</div></div></div><div class="glass"><h2 class="text-xl font-bold mb-4">‚ö° Quick Practice</h2><div class="grid grid-2 gap-4">${Object.entries(questions).map(([k, v]) => `<button class="subject-card" style="--from:${v.from};--to:${v.to}" onclick="setView('subjects')"><div class="icon">${v.icon}</div><div class="font-bold">${v.name}</div><div class="text-sm" style="opacity:0.7">${state.subjects[k]}/${stats.bySubject[k].total} done</div></button>`).join('')}</div></div>`; }

function qbankHTML(stats) {
    const diffOrder = ['A3', 'A4', 'M5', 'M6', 'E7', 'E8'];
    const typeOrder = ['mcq', 'fill', 'tf', 'multi', 'match', 'short'];
    return `<div class="glass"><h2 class="text-xl font-bold mb-4">üìä Question Bank Statistics</h2><div class="grid grid-2 gap-4 mb-4"><div class="stat-card"><div class="stat-num text-purple">${stats.total}</div><div class="stat-label">Total Questions</div></div><div class="stat-card"><div class="stat-num text-green">${Object.keys(questions).length}</div><div class="stat-label">Subjects</div></div></div></div>
    <div class="glass"><h3 class="text-lg font-bold mb-4">üìà Difficulty Distribution</h3><div class="diff-bar">${diffOrder.map(d => { const pct = (stats.byDiff[d] / stats.total * 100).toFixed(0); return pct > 0 ? `<div style="width:${pct}%;background:${diffColors[d]}">${d}</div>` : ''; }).join('')}</div><div class="grid grid-3 gap-2 mt-4">${diffOrder.map(d => `<div class="text-center"><span class="badge-tag" style="background:${diffColors[d]}">${d}</span><div class="font-bold mt-2">${stats.byDiff[d]}</div><div class="text-xs text-gray">${(stats.byDiff[d]/stats.total*100).toFixed(0)}%</div></div>`).join('')}</div></div>
    <div class="glass"><h3 class="text-lg font-bold mb-4">‚ùì Question Types</h3><div class="diff-bar">${typeOrder.map(t => { const pct = stats.byType[t] ? (stats.byType[t] / stats.total * 100).toFixed(0) : 0; return pct > 0 ? `<div style="width:${pct}%;background:${qTypes[t].color}">${qTypes[t].icon}</div>` : ''; }).join('')}</div><div class="grid grid-3 gap-2 mt-4">${typeOrder.map(t => `<div class="text-center"><span class="type-badge type-${t}">${qTypes[t].icon} ${qTypes[t].name}</span><div class="font-bold mt-2">${stats.byType[t] || 0}</div><div class="text-xs text-gray">${stats.byType[t] ? (stats.byType[t]/stats.total*100).toFixed(0) : 0}%</div></div>`).join('')}</div></div>
    ${Object.entries(questions).map(([k, v]) => {
        const ss = stats.bySubject[k];
        return `<div class="glass"><div class="flex items-center gap-3 mb-4"><span class="text-3xl">${v.icon}</span><div><h3 class="text-lg font-bold">${v.name}</h3><p class="text-sm text-gray">${ss.total} questions ¬∑ Target: <span class="badge-tag badge-purple">${v.target}</span></p></div></div><h4 class="font-bold mb-2">Difficulty</h4><div class="diff-bar">${diffOrder.map(d => { const pct = ss.diff[d] ? (ss.diff[d] / ss.total * 100).toFixed(0) : 0; return pct > 0 ? `<div style="width:${pct}%;background:${diffColors[d]}">${ss.diff[d]}</div>` : ''; }).join('')}</div><h4 class="font-bold mt-4 mb-2">Question Types</h4><div class="diff-bar">${typeOrder.map(t => { const pct = ss.type[t] ? (ss.type[t] / ss.total * 100).toFixed(0) : 0; return pct > 0 ? `<div style="width:${pct}%;background:${qTypes[t].color}">${ss.type[t]}</div>` : ''; }).join('')}</div><h4 class="font-bold mt-4 mb-2">By Topic</h4>${Object.entries(ss.topics).map(([topic, td]) => `<div class="stats-row"><span>${topic}</span><span>${td.total} Qs</span></div>`).join('')}</div>`;
    }).join('')}`;
}

function planHTML() { const t = getTodayStr(), cw = getCurrentWeek(), op = getOverallProgress(), tp = getDayPlan(t), pr = getDayProgress(t); return `<div class="glass"><div class="flex justify-between items-center mb-2"><h2 class="text-xl font-bold">üìÖ 6-Week Study Plan</h2><span class="badge-tag badge-purple">Week ${cw}/6</span></div><p class="text-gray text-sm mb-4">Dec 6, 2025 - Jan 17, 2026</p><div class="mb-4"><div class="flex justify-between text-sm mb-2"><span>Overall</span><span class="font-bold">${op}%</span></div><div class="progress-bar"><div class="progress-fill green" style="width:${op}%"></div></div></div>${tp && !tp.isRest ? `<div style="background:linear-gradient(135deg, ${tp.weekPlan.color.from}33, ${tp.weekPlan.color.to}33); border-left: 4px solid ${tp.weekPlan.color.from}; border-radius:12px; padding:15px; margin-bottom:10px"><div class="flex justify-between items-center mb-2"><div class="flex items-center gap-3"><span style="font-size:28px">${tp.icon}</span><div><div class="font-bold">Today</div><div class="text-sm text-gray">${tp.topic}</div></div></div><span class="task-status ${pr.completed ? 'status-complete' : pr.exams > 0 ? 'status-partial' : 'status-pending'}">${pr.completed ? '‚úì' : `${pr.exams}/${tp.goal}`}</span></div>${!pr.completed ? `<button class="btn btn-small btn-green" onclick="startDayTask('${t}')">Start ‚Üí</button>` : ''}</div>` : ''}</div><div class="glass"><h3 class="text-lg font-bold mb-4">üìñ Weekly Plan</h3>${weeklyPlan.map(w => `<div class="week-plan-card" style="--from:${w.color.from};--to:${w.color.to}"><span class="week-number">${w.week}</span><div class="flex items-center gap-3 mb-2"><span style="font-size:28px">${w.icon}</span><div><div class="font-bold">${w.name}: ${w.topic}</div><div class="text-sm" style="opacity:0.8">${w.dates} ¬∑ Target: ${w.targetGrade}</div></div></div><p class="text-sm mb-2" style="opacity:0.9">${w.description}</p><div style="display:flex;flex-wrap:wrap;gap:5px">${w.keyTopics.map(t => `<span class="topic-item">${t}</span>`).join('')}</div>${w.note ? `<div class="text-sm mt-2" style="opacity:0.8">${w.note}</div>` : ''}</div>`).join('')}</div><div class="glass"><h3 class="text-lg font-bold mb-4">üìÜ Calendar</h3>${[1,2,3,4,5,6].map(wn => { const wd = weeklyPlan[wn-1], days = dailyPlan.filter(d => d.week === wn), wp = getWeekProgress(wn), ic = wn === cw; return `<div class="week-card ${ic ? 'current' : ''}" style="--accent:${wd.color.from}"><div class="flex justify-between items-center mb-2"><div class="flex items-center gap-2"><span style="font-size:20px">${wd.icon}</span><span class="font-bold">${wd.name}</span><span class="text-sm text-gray">${wd.dates}</span></div><div class="flex items-center gap-2">${ic ? '<span class="badge-tag badge-yellow" style="font-size:10px">NOW</span>' : ''}<span class="text-sm font-bold">${wp}%</span></div></div><div class="calendar-grid">${['S','M','T','W','T','F','S'].map(d => `<div class="calendar-day-header">${d}</div>`).join('')}${renderWeekDays(days, t)}</div></div>`; }).join('')}</div>`; }
function renderWeekDays(days, today) { let h = ''; const fd = days[0]?.dayOfWeek || 0; for (let i = 0; i < fd; i++) h += '<div class="calendar-day disabled"></div>'; days.forEach(day => { const pr = getDayProgress(day.date), isT = day.date === today, isP = day.date < today, isF = day.date > today, pct = day.goal > 0 ? Math.min(100, (pr.exams / day.goal) * 100) : 100; let sc = ''; if (day.isRest) sc = 'rest-day'; else if (pr.completed) sc = 'completed'; else if (pr.exams > 0) sc = 'partial'; else if (isP) sc = 'past-incomplete'; else if (isF) sc = 'future'; const icon = day.isRest ? 'üéÑ' : (pr.completed ? '‚úÖ' : (pr.exams > 0 ? 'üìù' : (isP ? '‚ùå' : day.icon))); h += `<div class="calendar-day ${sc} ${isT ? 'today today-glow' : ''}" onclick="openDayDetail('${day.date}')"><span class="day-num">${new Date(day.date).getDate()}</span><span class="day-icon">${icon}</span>${!day.isRest && day.goal > 0 ? `<div class="day-progress"><div class="day-progress-fill" style="width:${pct}%"></div></div>` : ''}</div>`; }); const ld = days[days.length - 1]?.dayOfWeek || 6; for (let i = ld + 1; i <= 6; i++) h += '<div class="calendar-day disabled"></div>'; return h; }
function openDayDetail(d) { selectedDay = d; render(); }
function closeDayDetail() { selectedDay = null; render(); }
function dayDetailHTML() { const day = getDayPlan(selectedDay), pr = getDayProgress(selectedDay); if (!day) { selectedDay = null; return ''; } const df = new Date(selectedDay).toLocaleDateString('en-NZ', { weekday: 'long', month: 'short', day: 'numeric' }); return `<div class="glass"><button onclick="closeDayDetail()" class="text-gray mb-4" style="background:none;border:none;cursor:pointer">‚Üê Back</button><div class="flex items-center gap-4 mb-4"><span style="font-size:48px">${day.icon}</span><div><h2 class="text-2xl font-bold">${df}</h2><p class="text-gray">${day.isRest ? 'Rest Day üéÑ' : `${day.weekPlan.name} ¬∑ ${day.topic}`}</p></div></div>${day.isRest ? `<div class="alert alert-success"><p class="text-xl">üéâ Enjoy!</p></div>` : `<div class="mb-4"><div class="flex justify-between mb-2"><span>Progress</span><span class="font-bold">${pr.exams}/${day.goal}</span></div><div class="progress-bar"><div class="progress-fill ${pr.completed ? 'green' : ''}" style="width:${Math.min(100, (pr.exams / day.goal) * 100)}%"></div></div></div>${pr.completed ? `<div class="alert alert-success"><p class="font-bold">‚úÖ Complete!</p></div>` : ''}<button class="btn btn-green" onclick="startDayTask('${selectedDay}')">${pr.completed ? 'üìù Extra' : 'üöÄ Start'}</button>`}</div>${!day.isRest ? `<div class="glass"><h3 class="text-lg font-bold mb-4">üìö Topics</h3>${day.subject === 'all' ? Object.entries(questions).map(([k, v]) => `<button class="topic-btn" onclick="startExamFromDay('${selectedDay}', '${k}', '${Object.keys(v.topics)[0]}')">${v.icon} ${v.name}<span class="text-gray">${Object.values(v.topics).flat().length} Qs ‚Üí</span></button>`).join('') : Object.entries(questions[day.subject].topics).map(([topic, qs]) => `<button class="topic-btn" onclick="startExamFromDay('${selectedDay}', '${day.subject}', '${topic}')">${topic}<span class="text-gray">${qs.length} Qs ‚Üí</span></button>`).join('')}</div>` : ''}`; }
function startDayTask(d) { const day = getDayPlan(d); if (!day || day.isRest) return; selectedDay = d; if (day.subject === 'all') { const subs = ['math', 'english', 'science', 'social'], s = subs[Math.floor(Math.random() * subs.length)], ts = Object.keys(questions[s].topics); startExamFromDay(d, s, ts[Math.floor(Math.random() * ts.length)]); } else { const ts = Object.keys(questions[day.subject].topics); startExamFromDay(d, day.subject, ts[Math.floor(Math.random() * ts.length)]); } }
function startExamFromDay(d, sub, topic) { const qs = questions[sub].topics[topic]; if (!qs) return; const shuffled = [...qs].sort(() => Math.random() - 0.5).slice(0, Math.min(10, qs.length)); currentExam = { subject: sub, topic, questions: shuffled, startTime: Date.now(), forDate: d }; examState = { q: 0, answers: new Array(shuffled.length).fill(null) }; selectedDay = null; render(); }
function badgesHTML() { return `<div class="glass"><div class="flex justify-between items-center mb-4"><h2 class="text-xl font-bold">üèÖ Badges</h2><span class="badge-tag badge-purple">${state.badges.length}/${Object.keys(badgesDef).length}</span></div><div class="grid grid-3 gap-3">${Object.entries(badgesDef).map(([id, b]) => `<div class="badge-card ${state.badges.includes(id) ? 'earned' : 'locked'}"><span class="badge-icon">${b.icon}</span><div class="badge-name">${b.name}</div><div class="badge-desc">${b.desc}</div></div>`).join('')}</div></div>`; }
function subjectsHTML(stats) { return `<div class="glass"><h2 class="text-xl font-bold mb-4">üìö All Subjects</h2><p class="text-gray text-sm mb-4">Total: ${stats.total} questions</p>${Object.entries(questions).map(([k, v]) => `<div class="subject-card mb-4" style="--from:${v.from};--to:${v.to};cursor:default"><div class="flex items-center gap-4 mb-2"><span class="text-4xl">${v.icon}</span><div><div class="font-bold">${v.name}</div><div class="text-sm" style="opacity:0.7">${state.subjects[k]}/${stats.bySubject[k].total} done ¬∑ Target: ${v.target}</div></div></div>${Object.entries(v.topics).map(([topic, qs]) => `<button class="topic-btn" onclick="startExam('${k}','${topic}')">${topic}<span class="text-gray">${qs.length} ‚Üí</span></button>`).join('')}</div>`).join('')}</div>`; }
function statsHTML() { return `<div class="glass"><h2 class="text-xl font-bold mb-4">üìà All Stats</h2><div class="stats-row"><span>XP</span><span class="text-yellow font-bold">‚ö° ${state.xp}</span></div><div class="stats-row"><span>Exams</span><span class="text-green font-bold">‚úÖ ${state.exams}</span></div><div class="stats-row"><span>Streak</span><span style="color:#f97316" class="font-bold">üî• ${state.streak}</span></div><div class="stats-row"><span>Perfect 100%</span><span class="text-purple font-bold">üíØ ${state.perfect}</span></div><div class="stats-row"><span>Excellence</span><span style="color:#8b5cf6" class="font-bold">üèÜ ${state.excellence}</span></div><h3 class="text-lg font-bold mt-4 mb-2">By Subject</h3>${Object.entries(questions).map(([k, v]) => `<div class="stats-row"><span>${v.icon} ${v.name}</span><span>${state.subjects[k]}</span></div>`).join('')}</div>${state.history.length > 0 ? `<div class="glass"><h2 class="text-xl font-bold mb-4">üìú Recent</h2>${state.history.slice(0, 8).map(h => `<div class="stats-row"><span>${questions[h.subject].icon} ${h.topic.substring(0,15)}${h.topic.length>15?'...':''}</span><span class="badge-tag" style="background:${getGrade(h.score).color}">${h.grade}</span></div>`).join('')}</div>` : ''}`; }
function startExam(sub, topic) { const qs = questions[sub].topics[topic], shuffled = [...qs].sort(() => Math.random() - 0.5).slice(0, Math.min(10, qs.length)); currentExam = { subject: sub, topic, questions: shuffled, startTime: Date.now(), forDate: getTodayStr() }; examState = { q: 0, answers: new Array(shuffled.length).fill(null) }; render(); }

function examHTML() { 
    const q = currentExam.questions[examState.q], pct = ((examState.q + 1) / currentExam.questions.length) * 100, sub = questions[currentExam.subject], isLast = examState.q === currentExam.questions.length - 1;
    const qType = q.type || 'mcq';
    const allAnswered = examState.answers.every(a => a !== null);
    const typeInfo = qTypes[qType];
    
    return `<div class="glass"><div class="flex justify-between items-center mb-4"><div class="flex items-center gap-2"><span class="text-2xl">${sub.icon}</span><span class="font-bold">${currentExam.topic}</span></div><span class="badge-tag badge-blue">Q${examState.q + 1}/${currentExam.questions.length}</span></div><div class="progress-bar"><div class="progress-fill" style="width:${pct}%"></div></div><div class="q-dots">${currentExam.questions.map((_, i) => { let cls = 'q-dot'; if (i === examState.q) cls += ' current'; if (examState.answers[i] !== null) cls += ' answered'; return `<div class="${cls}" onclick="goToQuestion(${i})">${i+1}</div>`; }).join('')}</div></div>
    <div class="glass">
        <div class="flex gap-2 mb-4 flex-wrap">
            <span class="badge-tag" style="background:${diffColors[q.diff]}">${q.diff}</span>
            <span class="type-badge type-${qType}">${typeInfo.icon} ${typeInfo.name}</span>
        </div>
        <p class="text-sm text-gray mb-2">${typeInfo.desc}</p>
        <h2 class="text-xl font-bold" style="margin-bottom:25px">${q.q}</h2>
        ${renderQuestionByType(q, qType)}
        <div class="q-nav"><button class="btn btn-secondary btn-small" onclick="prevQuestion()" ${examState.q === 0 ? 'disabled' : ''}>‚Üê Prev</button>${isLast ? `<button class="btn btn-green btn-small" onclick="finishExam()" ${!allAnswered ? 'disabled' : ''}>‚úì Submit</button>` : `<button class="btn btn-blue btn-small" onclick="nextQuestion()">Next ‚Üí</button>`}</div>
    </div>
    <button onclick="exitExam()" class="text-gray mt-2" style="background:none;border:none;cursor:pointer">‚Üê Exit</button>`;
}

function renderQuestionByType(q, qType) {
    const currentAns = examState.answers[examState.q];
    
    switch(qType) {
        case 'mcq':
            return q.opts.map((opt, i) => {
                let cls = 'option-btn';
                if (currentAns === i) cls += ' selected';
                return `<button class="${cls}" onclick="selectAnswer(${i})">${String.fromCharCode(65+i)}. ${opt}</button>`;
            }).join('');
            
        case 'fill':
            return `<div class="text-center"><input type="text" class="fill-input" placeholder="Type your answer..." value="${currentAns || ''}" onchange="selectAnswer(this.value)" onkeyup="selectAnswer(this.value)"></div>`;
            
        case 'tf':
            return `<div class="tf-container">
                <button class="tf-btn ${currentAns === true ? 'selected-true' : ''}" onclick="selectAnswer(true)">‚úì True</button>
                <button class="tf-btn ${currentAns === false ? 'selected-false' : ''}" onclick="selectAnswer(false)">‚úó False</button>
            </div>`;
            
        case 'multi':
            const selected = Array.isArray(currentAns) ? currentAns : [];
            return q.opts.map((opt, i) => {
                const isSelected = selected.includes(i);
                return `<div class="multi-option ${isSelected ? 'selected' : ''}" onclick="toggleMultiAnswer(${i})">
                    <div class="multi-checkbox">${isSelected ? '‚úì' : ''}</div>
                    <span>${opt}</span>
                </div>`;
            }).join('');
            
        case 'match':
            const matchState = currentAns || { selected: null, pairs: [] };
            return renderMatchQuestion(q, matchState);
            
        case 'short':
            return `<textarea class="short-input" placeholder="Write your answer here..." onchange="selectAnswer(this.value)" onkeyup="selectAnswer(this.value)">${currentAns || ''}</textarea>`;
            
        default:
            return q.opts.map((opt, i) => {
                let cls = 'option-btn';
                if (currentAns === i) cls += ' selected';
                return `<button class="${cls}" onclick="selectAnswer(${i})">${String.fromCharCode(65+i)}. ${opt}</button>`;
            }).join('');
    }
}

function renderMatchQuestion(q, matchState) {
    const pairs = matchState.pairs || [];
    const pairedLeft = pairs.map(p => p[0]);
    const pairedRight = pairs.map(p => p[1]);
    
    return `<div class="match-container">
        <div class="match-col">
            <div class="text-sm text-gray mb-2 text-center">Items</div>
            ${q.left.map((item, i) => {
                const isPaired = pairedLeft.includes(i);
                const isSelected = matchState.selected === i;
                return `<div class="match-item ${isPaired ? 'matched' : ''} ${isSelected ? 'selected' : ''}" onclick="selectMatchLeft(${i})">${i+1}. ${item}</div>`;
            }).join('')}
        </div>
        <div class="match-lines">
            ${pairs.length > 0 ? pairs.map(p => `<div class="match-pair">${p[0]+1} ‚Üî ${String.fromCharCode(65+p[1])}</div>`).join('') : '<div class="text-gray text-sm">Click left,<br>then right</div>'}
            ${pairs.length > 0 ? `<button class="btn btn-small btn-secondary" onclick="clearMatches()">Clear</button>` : ''}
        </div>
        <div class="match-col">
            <div class="text-sm text-gray mb-2 text-center">Matches</div>
            ${q.right.map((item, i) => {
                const isPaired = pairedRight.includes(i);
                return `<div class="match-item ${isPaired ? 'matched' : ''}" onclick="selectMatchRight(${i})">${String.fromCharCode(65+i)}. ${item}</div>`;
            }).join('')}
        </div>
    </div>`;
}

function selectMatchLeft(i) {
    const q = currentExam.questions[examState.q];
    let matchState = examState.answers[examState.q] || { selected: null, pairs: [] };
    const pairedLeft = matchState.pairs.map(p => p[0]);
    if (pairedLeft.includes(i)) return; // Already paired
    matchState.selected = i;
    examState.answers[examState.q] = matchState;
    render();
}

function selectMatchRight(i) {
    const q = currentExam.questions[examState.q];
    let matchState = examState.answers[examState.q] || { selected: null, pairs: [] };
    const pairedRight = matchState.pairs.map(p => p[1]);
    if (pairedRight.includes(i)) return; // Already paired
    if (matchState.selected === null) return; // No left selected
    matchState.pairs.push([matchState.selected, i]);
    matchState.selected = null;
    // Mark as complete when all pairs made
    if (matchState.pairs.length === q.left.length) {
        examState.answers[examState.q] = matchState;
    } else {
        examState.answers[examState.q] = matchState;
    }
    render();
}

function clearMatches() {
    examState.answers[examState.q] = { selected: null, pairs: [] };
    render();
}

function toggleMultiAnswer(i) {
    let current = examState.answers[examState.q];
    if (!Array.isArray(current)) current = [];
    if (current.includes(i)) {
        current = current.filter(x => x !== i);
    } else {
        current = [...current, i];
    }
    examState.answers[examState.q] = current.length > 0 ? current : null;
    render();
}
function selectAnswer(i) { examState.answers[examState.q] = i; render(); }
function prevQuestion() { if (examState.q > 0) { examState.q--; render(); } }
function nextQuestion() { if (examState.q < currentExam.questions.length - 1) { examState.q++; render(); } }
function goToQuestion(i) { examState.q = i; render(); }
function finishExam() { 
    let correct = 0; 
    currentExam.questions.forEach((q, i) => { 
        if (checkAnswer(q, examState.answers[i])) correct++; 
    }); 
    const score = Math.round((correct / currentExam.questions.length) * 100), gi = getGrade(score), tt = Math.floor((Date.now() - currentExam.startTime) / 1000), fast = tt < 120, xp = Math.round(score * 2 + (fast ? 50 : 0)); 
    state.xp += xp; state.exams++; state.subjects[currentExam.subject]++; 
    if (score === 100) state.perfect++; 
    if (score >= 80) state.excellence++; 
    if (fast) state.fastExams = (state.fastExams || 0) + 1; 
    updateStreak(); updateDailyProgress(); 
    state.history.unshift({ subject: currentExam.subject, topic: currentExam.topic, score, grade: gi.grade, xp, date: new Date().toISOString() }); 
    state.history = state.history.slice(0, 20); 
    const earned = checkBadges(); 
    save(); showReview = true; render(); 
}

function checkAnswer(q, userAns) {
    const qType = q.type || 'mcq';
    
    switch(qType) {
        case 'mcq':
            return userAns === q.ans;
            
        case 'fill':
            if (!userAns) return false;
            const correct = String(q.ans).toLowerCase().trim();
            const user = String(userAns).toLowerCase().trim();
            return user === correct || user.replace(/\s+/g, '') === correct.replace(/\s+/g, '');
            
        case 'tf':
            return userAns === q.ans;
            
        case 'multi':
            if (!Array.isArray(userAns)) return false;
            const sortedUser = [...userAns].sort();
            const sortedCorrect = [...q.ans].sort();
            return JSON.stringify(sortedUser) === JSON.stringify(sortedCorrect);
            
        case 'match':
            if (!userAns || !userAns.pairs) return false;
            const userPairs = userAns.pairs.map(p => `${p[0]}-${p[1]}`).sort();
            const correctPairs = q.ans.map(p => `${p[0]}-${p[1]}`).sort();
            return JSON.stringify(userPairs) === JSON.stringify(correctPairs);
            
        case 'short':
            if (!userAns) return false;
            // Check if answer contains key words (simplified)
            const keywords = q.ans.toLowerCase().split(',').map(k => k.trim());
            const answer = userAns.toLowerCase();
            return keywords.some(k => answer.includes(k));
            
        default:
            return userAns === q.ans;
    }
}

function reviewHTML() { 
    const correct = currentExam.questions.filter((q, i) => checkAnswer(q, examState.answers[i])).length;
    const score = Math.round((correct / currentExam.questions.length) * 100), gi = getGrade(score);
    const t = getTodayStr(), tp = getDayPlan(t), pr = getDayProgress(t);
    return `<div class="glass text-center"><div class="text-6xl mb-4">${gi.emoji}</div><h1 class="text-3xl font-bold mb-4">Complete!</h1><div class="flex justify-center gap-4 mb-4 flex-wrap"><div><div class="text-3xl font-bold" style="color:${gi.color}">${score}%</div><div class="text-gray text-sm">Score</div></div><div><div class="text-3xl font-bold" style="color:${gi.color}">${gi.grade}</div><div class="text-gray text-sm">${gi.label}</div></div><div><div class="text-3xl font-bold text-yellow">+${Math.round(score * 2)}</div><div class="text-gray text-sm">XP</div></div></div>${tp && !tp.isRest ? `<div class="mb-4"><p class="text-sm text-gray mb-2">Today: ${pr.exams}/${tp.goal}</p><div class="progress-bar"><div class="progress-fill ${pr.completed ? 'green' : ''}" style="width:${Math.min(100, (pr.exams / tp.goal) * 100)}%"></div></div></div>` : ''}${newBadges.length > 0 ? `<div class="alert alert-success mb-4"><h3 class="font-bold mb-2">üéâ New Badge!</h3><div class="flex justify-center gap-3">${newBadges.map(id => `<span style="font-size:40px">${badgesDef[id].icon}</span>`).join('')}</div></div>` : ''}</div>
    <div class="glass"><h3 class="text-lg font-bold mb-4">üìù Review - All Questions</h3>${currentExam.questions.map((q, i) => { 
        const isC = checkAnswer(q, examState.answers[i]);
        const userAns = examState.answers[i];
        const qType = q.type || 'mcq';
        const typeInfo = qTypes[qType];
        return `<div class="review-item ${isC ? 'correct' : 'wrong'}">
            <div class="flex justify-between items-start mb-2">
                <div class="flex gap-2">
                    <span class="badge-tag" style="background:${diffColors[q.diff]}">${q.diff}</span>
                    <span class="type-badge type-${qType}">${typeInfo.icon}</span>
                </div>
                <span class="${isC ? 'text-green' : 'text-red'} font-bold">${isC ? '‚úì Correct' : '‚úó Wrong'}</span>
            </div>
            <div class="review-q">Q${i+1}: ${q.q}</div>
            <div class="review-answer">${renderReviewAnswer(q, userAns, qType, isC)}<p class="text-purple text-sm mt-2">üí° ${q.exp}</p></div>
        </div>`;
    }).join('')}</div>
    <button class="btn" onclick="backToMain()">Continue üöÄ</button>`;
}

function renderReviewAnswer(q, userAns, qType, isCorrect) {
    switch(qType) {
        case 'mcq':
            return `<p><span class="text-gray">Your answer:</span> <span class="${isCorrect ? 'text-green' : 'text-red'}">${userAns !== null ? q.opts[userAns] : 'No answer'}</span></p>${!isCorrect ? `<p><span class="text-gray">Correct:</span> <span class="text-green">${q.opts[q.ans]}</span></p>` : ''}`;
            
        case 'fill':
            return `<p><span class="text-gray">Your answer:</span> <span class="${isCorrect ? 'text-green' : 'text-red'}">${userAns || 'No answer'}</span></p>${!isCorrect ? `<p><span class="text-gray">Correct:</span> <span class="text-green">${q.ans}</span></p>` : ''}`;
            
        case 'tf':
            const userTF = userAns === true ? 'True' : userAns === false ? 'False' : 'No answer';
            const correctTF = q.ans ? 'True' : 'False';
            return `<p><span class="text-gray">Your answer:</span> <span class="${isCorrect ? 'text-green' : 'text-red'}">${userTF}</span></p>${!isCorrect ? `<p><span class="text-gray">Correct:</span> <span class="text-green">${correctTF}</span></p>` : ''}`;
            
        case 'multi':
            const userMulti = Array.isArray(userAns) ? userAns.map(i => q.opts[i]).join(', ') : 'No answer';
            const correctMulti = q.ans.map(i => q.opts[i]).join(', ');
            return `<p><span class="text-gray">Your selection:</span> <span class="${isCorrect ? 'text-green' : 'text-red'}">${userMulti}</span></p>${!isCorrect ? `<p><span class="text-gray">Correct:</span> <span class="text-green">${correctMulti}</span></p>` : ''}`;
            
        case 'match':
            const userPairs = userAns && userAns.pairs ? userAns.pairs.map(p => `${q.left[p[0]]} ‚Üî ${q.right[p[1]]}`).join(', ') : 'No answer';
            const correctPairs = q.ans.map(p => `${q.left[p[0]]} ‚Üî ${q.right[p[1]]}`).join(', ');
            return `<p><span class="text-gray">Your matches:</span> <span class="${isCorrect ? 'text-green' : 'text-red'}">${userPairs}</span></p>${!isCorrect ? `<p><span class="text-gray">Correct:</span> <span class="text-green">${correctPairs}</span></p>` : ''}`;
            
        case 'short':
            return `<p><span class="text-gray">Your answer:</span> <span class="${isCorrect ? 'text-green' : 'text-red'}">${userAns || 'No answer'}</span></p>${!isCorrect ? `<p><span class="text-gray">Keywords:</span> <span class="text-green">${q.ans}</span></p>` : ''}`;
            
        default:
            return `<p><span class="text-gray">Your answer:</span> <span class="${isCorrect ? 'text-green' : 'text-red'}">${userAns !== null ? q.opts[userAns] : 'No answer'}</span></p>`;
    }
}

function backToMain() { currentExam = null; newBadges = []; showReview = false; view = 'dashboard'; render(); }
function exitExam() { currentExam = null; showReview = false; view = 'dashboard'; render(); }

// Init
if (!state.dailyProgress) state.dailyProgress = {};
view = state.name ? 'dashboard' : 'welcome';
render();
    </script>
</body>
</html>
